

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>h2o.frame &mdash; H2O  documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,300,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="H2O  documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../../index.html" class="fa fa-home"> H2O</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">The H2O Python Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../intro.html#what-is-h2o">What is H2O?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro.html#h2o-cluster-inspection">H2O Cluster Inspection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro.html#objects-in-this-module">Objects In This Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro.html#example-of-h2o-on-hadoop">Example of H2O on Hadoop</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../h2o.html">H2O Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../h2o.html#module-h2o.h2o"><code class="docutils literal"><span class="pre">h2o</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../data.html">Data In H2O</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../data.html#loading-data-from-a-csv-file">Loading Data From A CSV File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data.html#loading-data-from-a-python-object">Loading Data From A Python Object</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../frame.html">Data Manipulation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../frame.html#h2oframe"><code class="docutils literal"><span class="pre">H2OFrame</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../frame.html#groupby"><code class="docutils literal"><span class="pre">GroupBy</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../modeling.html">Modeling In H2O</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../modeling.html#h2oestimator"><code class="docutils literal"><span class="pre">H2OEstimator</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling.html#h2odeeplearningestimator"><code class="docutils literal"><span class="pre">H2ODeepLearningEstimator</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling.html#h2oautoencoderestimator"><code class="docutils literal"><span class="pre">H2OAutoEncoderEstimator</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling.html#h2orandomforestestimator"><code class="docutils literal"><span class="pre">H2ORandomForestEstimator</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling.html#h2ogradientboostingestimator"><code class="docutils literal"><span class="pre">H2OGradientBoostingEstimator</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling.html#h2ogeneralizedlinearestimator"><code class="docutils literal"><span class="pre">H2OGeneralizedLinearEstimator</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling.html#h2ogeneralizedlowrankestimator"><code class="docutils literal"><span class="pre">H2OGeneralizedLowRankEstimator</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling.html#h2okmeansestimator"><code class="docutils literal"><span class="pre">H2OKMeansEstimator</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modeling.html#h2onaivebayesestimator"><code class="docutils literal"><span class="pre">H2ONaiveBayesEstimator</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../model_categories.html">Model Categories</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../model_categories.html#module-h2o.model.model_base"><code class="docutils literal"><span class="pre">ModelBase</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_categories.html#module-h2o.model.binomial"><code class="docutils literal"><span class="pre">Binomial</span> <span class="pre">Classification</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_categories.html#module-h2o.model.multinomial"><code class="docutils literal"><span class="pre">Multinomial</span> <span class="pre">Classification</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_categories.html#module-h2o.model.regression"><code class="docutils literal"><span class="pre">Regression</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_categories.html#module-h2o.model.clustering"><code class="docutils literal"><span class="pre">Clustering</span> <span class="pre">Methods</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model_categories.html#module-h2o.model.autoencoder"><code class="docutils literal"><span class="pre">AutoEncoders</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../metrics.html">Metrics in H2O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../assembly.html">H2OAssembly</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../other.html">REST Interface</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">H2O</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>h2o.frame</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <h1>Source code for h2o.frame</h1><div class="highlight"><pre>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="c"># import numpy    no numpy cuz windoz</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>

<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">six</span> <span class="kn">import</span> <span class="n">iteritems</span><span class="p">,</span> <span class="n">itervalues</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">imp</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">from</span> <span class="nn">.utils.shared_utils</span> <span class="kn">import</span> <span class="n">_quoted</span><span class="p">,</span> <span class="n">can_use_pandas</span><span class="p">,</span> <span class="n">_handle_python_lists</span><span class="p">,</span> <span class="n">_is_list</span><span class="p">,</span> <span class="n">_is_str_list</span><span class="p">,</span> <span class="n">_handle_python_dicts</span><span class="p">,</span> <span class="n">quote</span>
<span class="kn">from</span> <span class="nn">.display</span> <span class="kn">import</span> <span class="n">H2ODisplay</span>
<span class="kn">from</span> <span class="nn">.connection</span> <span class="kn">import</span> <span class="n">H2OConnection</span>
<span class="kn">from</span> <span class="nn">.job</span> <span class="kn">import</span> <span class="n">H2OJob</span>
<span class="kn">from</span> <span class="nn">.expr</span> <span class="kn">import</span> <span class="n">ExprNode</span>
<span class="kn">from</span> <span class="nn">.group_by</span> <span class="kn">import</span> <span class="n">GroupBy</span>
<span class="kn">import</span> <span class="nn">h2o</span>
<span class="kn">from</span> <span class="nn">past.builtins</span> <span class="kn">import</span> <span class="nb">basestring</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="nb">reduce</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s">&quot;pandas&quot;</span><span class="p">,</span> <span class="n">lineno</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>


<span class="c"># TODO: Automatically convert column names into Frame properties!</span>
<div class="viewcode-block" id="H2OFrame"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame">[docs]</a><span class="k">class</span> <span class="nc">H2OFrame</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">python_obj</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span> <span class="o">=</span> <span class="n">ExprNode</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_children</span><span class="o">=</span><span class="bp">None</span>
    <span class="k">if</span> <span class="n">python_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_upload_python_object</span><span class="p">(</span><span class="n">python_obj</span><span class="p">)</span>

  <span class="nd">@property</span>
  <span class="k">def</span> <span class="nf">columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A list of column names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span>

  <span class="nd">@columns.setter</span>
  <span class="k">def</span> <span class="nf">columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set the column names of this H2OFrame.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      value : list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_names</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

  <span class="nd">@property</span>
  <span class="k">def</span> <span class="nf">col_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A list of column names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span>

  <span class="nd">@col_names.setter</span>
  <span class="k">def</span> <span class="nf">col_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set the column names of this H2OFrame.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      value : list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_names</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

  <span class="nd">@property</span>
  <span class="k">def</span> <span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Retrieve the column names (one name per H2OVec) for this H2OFrame.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A str list of column names</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">names_valid</span><span class="p">():</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_frame</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">names</span>

  <span class="nd">@names.setter</span>
  <span class="k">def</span> <span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set the column names of this H2OFrame.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      value : list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_names</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

  <span class="nd">@property</span>
  <span class="k">def</span> <span class="nf">nrow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      The number of rows in the H2OFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">nrows_valid</span><span class="p">():</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_frame</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">nrows</span>

  <span class="nd">@property</span>
  <span class="k">def</span> <span class="nf">ncol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      The number of columns in the H2OFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">ncols_valid</span><span class="p">():</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_frame</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">ncols</span>

  <span class="nd">@property</span>
  <span class="k">def</span> <span class="nf">dim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      The number of rows and columns in the H2OFrame as a list [rows, cols].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nrow</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span><span class="p">]</span>

  <span class="nd">@property</span>
  <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A tuple (nrow, ncol)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span>

  <span class="nd">@property</span>
  <span class="k">def</span> <span class="nf">types</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A dictionary of column_name-type pairs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types_valid</span><span class="p">():</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_frame</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span>

  <span class="nd">@property</span>
  <span class="k">def</span> <span class="nf">frame_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      Get the name of this frame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frame</span><span class="p">()</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">_id</span>

  <span class="nd">@frame_id.setter</span>
  <span class="k">def</span> <span class="nf">frame_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">_id</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="n">h2o</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">oldname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">_id</span> <span class="o">=</span> <span class="n">value</span>
      <span class="n">h2o</span><span class="o">.</span><span class="n">rapids</span><span class="p">(</span><span class="s">&quot;(rename </span><span class="se">\&quot;</span><span class="s">{}</span><span class="se">\&quot;</span><span class="s"> </span><span class="se">\&quot;</span><span class="s">{}</span><span class="se">\&quot;</span><span class="s">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">oldname</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span><span class="n">cache</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="p">()</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span> <span class="o">=</span> <span class="n">expr</span>
    <span class="k">if</span> <span class="n">cache</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">fill_from</span><span class="p">(</span><span class="n">cache</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fr</span>

  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OFrame.get_frame"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.get_frame">[docs]</a>  <span class="k">def</span> <span class="nf">get_frame</span><span class="p">(</span><span class="n">frame_id</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create an H2OFrame mapped to an existing id in the cluster.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame that points to a pre-existing big data H2OFrame in the cluster</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="p">()</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">_id</span> <span class="o">=</span> <span class="n">frame_id</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">fill</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fr</span></div>

  <span class="k">def</span> <span class="nf">_import_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">destination_frame</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">column_names</span><span class="p">,</span> <span class="n">column_types</span><span class="p">,</span> <span class="n">na_strings</span><span class="p">):</span>
    <span class="n">rawkey</span> <span class="o">=</span> <span class="n">h2o</span><span class="o">.</span><span class="n">lazy_import</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="n">rawkey</span><span class="p">,</span><span class="n">destination_frame</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">column_names</span><span class="p">,</span> <span class="n">column_types</span><span class="p">,</span> <span class="n">na_strings</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span>

  <span class="k">def</span> <span class="nf">_upload_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">destination_frame</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">column_names</span><span class="p">,</span> <span class="n">column_types</span><span class="p">,</span> <span class="n">na_strings</span><span class="p">):</span>
    <span class="n">fui</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;file&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path</span><span class="p">)}</span>
    <span class="n">rawkey</span> <span class="o">=</span> <span class="n">H2OConnection</span><span class="o">.</span><span class="n">post_json</span><span class="p">(</span><span class="n">url_suffix</span><span class="o">=</span><span class="s">&quot;PostFile&quot;</span><span class="p">,</span> <span class="n">file_upload_info</span><span class="o">=</span><span class="n">fui</span><span class="p">)[</span><span class="s">&quot;destination_frame&quot;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="n">rawkey</span><span class="p">,</span><span class="n">destination_frame</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">column_names</span><span class="p">,</span> <span class="n">column_types</span><span class="p">,</span> <span class="n">na_strings</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span>

  <span class="k">def</span> <span class="nf">_upload_python_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">python_obj</span><span class="p">,</span> <span class="n">destination_frame</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">separator</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">column_names</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">column_types</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">na_strings</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="c"># [] and () cases -- folded together since H2OFrame is mutable</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">python_obj</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span> <span class="n">col_header</span><span class="p">,</span> <span class="n">data_to_write</span> <span class="o">=</span> <span class="n">_handle_python_lists</span><span class="p">(</span><span class="n">python_obj</span><span class="p">)</span>

    <span class="c"># {} and collections.OrderedDict cases</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">python_obj</span><span class="p">,</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">)):</span> <span class="n">col_header</span><span class="p">,</span> <span class="n">data_to_write</span> <span class="o">=</span> <span class="n">_handle_python_dicts</span><span class="p">(</span><span class="n">python_obj</span><span class="p">)</span>

    <span class="c"># handle a numpy.ndarray</span>
    <span class="c"># elif isinstance(python_obj, numpy.ndarray):</span>
    <span class="c">#</span>
    <span class="c">#     header, data_to_write = H2OFrame._handle_numpy_array(python_obj)</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;`python_obj` must be a tuple, list, dict, collections.OrderedDict. Got: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">python_obj</span><span class="p">)))</span>

    <span class="k">if</span> <span class="n">col_header</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">data_to_write</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;No data to write&quot;</span><span class="p">)</span>

    <span class="c">#</span>
    <span class="c">## write python data to file and upload</span>
    <span class="c">#</span>

    <span class="c"># create a temporary file that will be written to</span>
    <span class="n">tmp_handle</span><span class="p">,</span><span class="n">tmp_path</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkstemp</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s">&quot;.csv&quot;</span><span class="p">)</span>
    <span class="n">tmp_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">fdopen</span><span class="p">(</span><span class="n">tmp_handle</span><span class="p">,</span><span class="s">&#39;w&#39;</span><span class="p">)</span>
    <span class="c"># create a new csv writer object thingy</span>
    <span class="n">csv_writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictWriter</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">,</span> <span class="n">fieldnames</span><span class="o">=</span><span class="n">col_header</span><span class="p">,</span> <span class="n">restval</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="s">&quot;excel&quot;</span><span class="p">,</span> <span class="n">extrasaction</span><span class="o">=</span><span class="s">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&quot;,&quot;</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span><span class="p">)</span>
    <span class="c">#csv_writer.writeheader()              # write the header</span>
    <span class="k">if</span> <span class="n">column_names</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">column_names</span> <span class="o">=</span> <span class="n">col_header</span>
    <span class="n">csv_writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">data_to_write</span><span class="p">)</span>    <span class="c"># write the data</span>
    <span class="n">tmp_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>                       <span class="c"># close the streams</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_upload_parse</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">,</span> <span class="n">destination_frame</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">column_names</span><span class="p">,</span> <span class="n">column_types</span><span class="p">,</span> <span class="n">na_strings</span><span class="p">)</span>  <span class="c"># actually upload the data to H2O</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">)</span>                    <span class="c"># delete the tmp file</span>

  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OFrame.from_python"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.from_python">[docs]</a>  <span class="k">def</span> <span class="nf">from_python</span><span class="p">(</span><span class="n">python_obj</span><span class="p">,</span> <span class="n">destination_frame</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">separator</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">column_names</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">column_types</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">na_strings</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Properly handle native python data types. For a discussion of the rules and</span>
<span class="sd">    permissible data types please refer to the main documentation for H2OFrame.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      python_obj : tuple, list, dict, collections.OrderedDict</span>
<span class="sd">        If a nested list/tuple, then each nested collection is a row.</span>
<span class="sd">      destination_frame : str, optional</span>
<span class="sd">        The unique hex key assigned to the imported file. If none is given, a key will</span>
<span class="sd">        automatically be generated.</span>
<span class="sd">      header : int, optional</span>
<span class="sd">       -1 means the first line is data, 0 means guess, 1 means first line is header.</span>
<span class="sd">      sep : str, optional</span>
<span class="sd">        The field separator character. Values on each line of the file are separated by</span>
<span class="sd">        this character. If sep = &quot;&quot;, the parser will automatically detect the separator.</span>
<span class="sd">      col_names : list, optional</span>
<span class="sd">        A list of column names for the file.</span>
<span class="sd">      col_types : list or dict, optional</span>
<span class="sd">        A list of types or a dictionary of column names to types to specify whether</span>
<span class="sd">        columns should be forced to a certain type upon import parsing. If a list, the</span>
<span class="sd">        types for elements that are None will be guessed. The possible types a column may</span>
<span class="sd">        have are.</span>
<span class="sd">      na_strings : list or dict, optional</span>
<span class="sd">        A list of strings, or a list of lists of strings (one list per column), or a</span>
<span class="sd">        dictionary of column names to strings which are to be interpreted as missing values.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A new H2OFrame instance.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">      &gt;&gt;&gt; l = [[1,2,3,4,5], [99,123,51233,321]]</span>
<span class="sd">      &gt;&gt;&gt; l = H2OFrame(l)</span>
<span class="sd">      &gt;&gt;&gt; l</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="p">()</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_upload_python_object</span><span class="p">(</span><span class="n">python_obj</span><span class="p">,</span> <span class="n">destination_frame</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">column_names</span><span class="p">,</span> <span class="n">column_types</span><span class="p">,</span> <span class="n">na_strings</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fr</span></div>

  <span class="k">def</span> <span class="nf">_parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rawkey</span><span class="p">,</span> <span class="n">destination_frame</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">column_names</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">column_types</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">na_strings</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">setup</span> <span class="o">=</span> <span class="n">h2o</span><span class="o">.</span><span class="n">parse_setup</span><span class="p">(</span><span class="n">rawkey</span><span class="p">,</span> <span class="n">destination_frame</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">column_names</span><span class="p">,</span> <span class="n">column_types</span><span class="p">,</span> <span class="n">na_strings</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_raw</span><span class="p">(</span><span class="n">setup</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_parse_raw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setup</span><span class="p">):</span>
    <span class="c"># Parse parameters (None values provided by setup)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;destination_frame&quot;</span> <span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
          <span class="s">&quot;parse_type&quot;</span>        <span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
          <span class="s">&quot;separator&quot;</span>         <span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
          <span class="s">&quot;single_quotes&quot;</span>     <span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
          <span class="s">&quot;check_header&quot;</span>      <span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
          <span class="s">&quot;number_columns&quot;</span>    <span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
          <span class="s">&quot;chunk_size&quot;</span>        <span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
          <span class="s">&quot;delete_on_done&quot;</span>    <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
          <span class="s">&quot;blocking&quot;</span>          <span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
          <span class="s">&quot;column_types&quot;</span>      <span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
          <span class="p">}</span>

    <span class="k">if</span> <span class="n">setup</span><span class="p">[</span><span class="s">&quot;column_names&quot;</span><span class="p">]:</span> <span class="n">p</span><span class="p">[</span><span class="s">&quot;column_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">setup</span><span class="p">[</span><span class="s">&quot;na_strings&quot;</span><span class="p">]:</span> <span class="n">p</span><span class="p">[</span><span class="s">&quot;na_strings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="n">p</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">setup</span><span class="p">)</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">p</span><span class="p">})</span>

    <span class="c"># Extract only &#39;name&#39; from each src in the array of srcs</span>
    <span class="n">p</span><span class="p">[</span><span class="s">&#39;source_frames&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">_quoted</span><span class="p">(</span><span class="n">src</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">setup</span><span class="p">[</span><span class="s">&#39;source_frames&#39;</span><span class="p">]]</span>

    <span class="n">H2OJob</span><span class="p">(</span><span class="n">H2OConnection</span><span class="o">.</span><span class="n">post_json</span><span class="p">(</span><span class="n">url_suffix</span><span class="o">=</span><span class="s">&quot;Parse&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">p</span><span class="p">),</span> <span class="s">&quot;Parse&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span>
    <span class="c"># Need to return a Frame here for nearly all callers</span>
    <span class="c"># ... but job stats returns only a dest_key, requiring another REST call to get nrow/ncol</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">_id</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s">&quot;destination_frame&quot;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">fill</span><span class="p">()</span>

<div class="viewcode-block" id="H2OFrame.filter_na_cols"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.filter_na_cols">[docs]</a>  <span class="k">def</span> <span class="nf">filter_na_cols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">0.2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Filter columns with proportion of NAs &gt;= frac.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    frac : float</span>
<span class="sd">      Fraction of NAs in the column.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A list of column indices that have a fewer count of NAs.</span>
<span class="sd">      If all columns are filtered, None is returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;filterNACols&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">frac</span><span class="p">)</span><span class="o">.</span><span class="n">_eager_scalar</span><span class="p">()</span></div>

<div class="viewcode-block" id="H2OFrame.type"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.type">[docs]</a>  <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      The type for a named column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="n">name</span><span class="p">]</span></div>

  <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncol</span><span class="p">))</span>
  <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">gettrace</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="k">return</span> <span class="s">&quot;This H2OFrame has been removed.&quot;</span>
      <span class="n">row_string</span> <span class="o">=</span> <span class="s">&#39; rows x &#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span> <span class="o">!=</span> <span class="mi">1</span> <span class="k">else</span> <span class="s">&#39; row x &#39;</span>
      <span class="n">column_string</span> <span class="o">=</span> <span class="s">&#39; columns]&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span> <span class="o">!=</span> <span class="mi">1</span> <span class="k">else</span> <span class="s">&#39; column]&#39;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frame</span><span class="p">()</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">_tabulate</span><span class="p">(</span><span class="s">&quot;simple&quot;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n\n</span><span class="s">[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrow</span><span class="p">)</span> \
    <span class="o">+</span> <span class="n">row_string</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncol</span><span class="p">)</span> <span class="o">+</span> <span class="n">column_string</span>
    <span class="k">return</span> <span class="s">&quot;&quot;</span>
  <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span>

  <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">gettrace</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="c"># PUBDEV-2278: using &lt;method&gt;? from IPython caused everything to dump</span>
      <span class="n">stk</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">extract_stack</span><span class="p">()</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="s">&quot;IPython&quot;</span> <span class="ow">in</span> <span class="n">stk</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="s">&quot;info&quot;</span> <span class="o">==</span> <span class="n">stk</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="s">&quot;&quot;</span>

<div class="viewcode-block" id="H2OFrame.show"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.show">[docs]</a>  <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_pandas</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used by the H2OFrame.__repr__ method to print or display a snippet of the data frame.</span>
<span class="sd">    If called from IPython, displays an html&#39;ized result</span>
<span class="sd">    Else prints a tabulate&#39;d result</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> 
      <span class="k">print</span><span class="p">(</span><span class="s">&quot;This H2OFrame has been removed.&quot;</span><span class="p">)</span>
      <span class="k">return</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frame</span><span class="p">()</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">fill</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">H2ODisplay</span><span class="o">.</span><span class="n">_in_ipy</span><span class="p">():</span>
      <span class="kn">import</span> <span class="nn">IPython.display</span>
      <span class="k">if</span> <span class="n">use_pandas</span> <span class="ow">and</span> <span class="n">can_use_pandas</span><span class="p">():</span>
        <span class="n">IPython</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">as_data_frame</span><span class="p">(</span><span class="bp">True</span><span class="p">))</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">IPython</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">display_html</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">_tabulate</span><span class="p">(</span><span class="s">&quot;html&quot;</span><span class="p">,</span><span class="bp">False</span><span class="p">),</span><span class="n">raw</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">use_pandas</span> <span class="ow">and</span> <span class="n">can_use_pandas</span><span class="p">():</span>
        <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">as_data_frame</span><span class="p">(</span><span class="bp">True</span><span class="p">))</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="H2OFrame.summary"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.summary">[docs]</a>  <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Summary: show(), plus includes min/mean/max/sigma and other rollup data&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frame</span><span class="p">()</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">fill</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">H2ODisplay</span><span class="o">.</span><span class="n">_in_ipy</span><span class="p">():</span>
      <span class="kn">import</span> <span class="nn">IPython.display</span>
      <span class="n">IPython</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">display_html</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">_tabulate</span><span class="p">(</span><span class="s">&quot;html&quot;</span><span class="p">,</span><span class="bp">True</span><span class="p">),</span><span class="n">raw</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">_tabulate</span><span class="p">(</span><span class="s">&quot;simple&quot;</span><span class="p">,</span><span class="bp">True</span><span class="p">))</span></div>

<div class="viewcode-block" id="H2OFrame.describe"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.describe">[docs]</a>  <span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate an in-depth description of this H2OFrame. Everything in summary(), plus</span>
<span class="sd">    the data layout.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># Force a fetch of 10 rows; the chunk &amp; distribution summaries are not</span>
    <span class="c"># cached, so must be pulled.  While we&#39;re at it, go ahead and fill in</span>
    <span class="c"># the default caches if they are not already filled in</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">H2OConnection</span><span class="o">.</span><span class="n">get_json</span><span class="p">(</span><span class="s">&quot;Frames/&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span><span class="o">+</span><span class="s">&quot;?row_count=&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">10</span><span class="p">))[</span><span class="s">&quot;frames&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">_fill_data</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Rows:{:,}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrow</span><span class="p">),</span> <span class="s">&quot;Cols:{:,}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncol</span><span class="p">))</span>
    <span class="n">res</span><span class="p">[</span><span class="s">&quot;chunk_summary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">res</span><span class="p">[</span><span class="s">&quot;distribution_summary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span></div>

  <span class="k">def</span> <span class="nf">_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fill_cache</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_eager_frame</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">fill_cache</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">fill</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span>

<div class="viewcode-block" id="H2OFrame.head"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.head">[docs]</a>  <span class="k">def</span> <span class="nf">head</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">rows</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span><span class="mi">200</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Analogous to Rs `head` call on a data.frame.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rows : int, default=10</span>
<span class="sd">      Number of rows starting from the topmost</span>
<span class="sd">    cols : int, default=200</span>
<span class="sd">      Number of columns starting from the leftmost</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      An H2OFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrow</span><span class="p">,</span> <span class="n">rows</span><span class="p">)</span>
    <span class="n">ncols</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncol</span><span class="p">,</span> <span class="n">cols</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="p">[:</span><span class="n">nrows</span><span class="p">,:</span><span class="n">ncols</span><span class="p">]</span></div>

<div class="viewcode-block" id="H2OFrame.tail"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.tail">[docs]</a>  <span class="k">def</span> <span class="nf">tail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">200</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Analogous to Rs `tail` call on a data.frame.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rows : int, default=10</span>
<span class="sd">      Number of rows starting from the bottommost</span>
<span class="sd">    cols: int, default=200</span>
<span class="sd">      Number of columns starting from the leftmost</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      An H2OFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrow</span><span class="p">,</span> <span class="n">rows</span><span class="p">)</span>
    <span class="n">ncols</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncol</span><span class="p">,</span> <span class="n">cols</span><span class="p">)</span>
    <span class="n">start_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span> <span class="o">-</span> <span class="n">nrows</span>
    <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">start_idx</span><span class="o">+</span><span class="n">nrows</span><span class="p">,:</span><span class="n">ncols</span><span class="p">]</span></div>

<div class="viewcode-block" id="H2OFrame.logical_negation"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.logical_negation">[docs]</a>  <span class="k">def</span> <span class="nf">logical_negation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;not&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>

  <span class="c"># ops</span>
  <span class="k">def</span> <span class="nf">__add__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;+&quot;</span><span class="p">,</span>   <span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__sub__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;-&quot;</span><span class="p">,</span>   <span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__mul__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;*&quot;</span><span class="p">,</span>   <span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__div__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>  <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">,</span>   <span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__truediv__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">,</span>   <span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__floordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;intDiv&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__mod__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;mod&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__or__</span>  <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;|&quot;</span><span class="p">,</span>   <span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__and__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;&amp;&quot;</span><span class="p">,</span>   <span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__ge__</span>  <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;&gt;=&quot;</span><span class="p">,</span>  <span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__gt__</span>  <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;&gt;&quot;</span><span class="p">,</span>   <span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__le__</span>  <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;&lt;=&quot;</span><span class="p">,</span>  <span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__lt__</span>  <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;&lt;&quot;</span><span class="p">,</span>   <span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__eq__</span>  <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">i</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s">&quot;nan&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;==&quot;</span><span class="p">,</span>  <span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__ne__</span>  <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">i</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s">&quot;nan&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;!=&quot;</span><span class="p">,</span>  <span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__pow__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;^&quot;</span><span class="p">,</span>   <span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="nb">all</span><span class="p">([(</span><span class="n">t</span><span class="o">==</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="n">_is_list</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
  <span class="c"># rops</span>
  <span class="k">def</span> <span class="nf">__rmod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;mod&quot;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__add__</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;-&quot;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span>  <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__rand__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__and__</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__ror__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__or__</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span>  <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__rdiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span>  <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__rfloordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;intDiv&quot;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mul__</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;^&quot;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span>  <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="c"># unops</span>
  <span class="k">def</span> <span class="nf">__abs__</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;abs&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__invert__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;!!&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">__nonzero__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> 
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;This operation is not supported on an H2OFrame. Try using parantheses. Did you mean &amp; (logical and), | (logical or), or ~ (logical not)?&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__len__</span><span class="p">()</span>


<div class="viewcode-block" id="H2OFrame.mult"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.mult">[docs]</a>  <span class="k">def</span> <span class="nf">mult</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matrix</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform matrix multiplication.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      matrix : H2OFrame</span>
<span class="sd">        The right-hand-side matrix</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame result of the matrix multiplication</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">matrix</span><span class="p">))</span></div>

<div class="viewcode-block" id="H2OFrame.cos"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.cos">[docs]</a>  <span class="k">def</span> <span class="nf">cos</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>     <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;cos&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.sin"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.sin">[docs]</a>  <span class="k">def</span> <span class="nf">sin</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>     <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;sin&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.tan"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.tan">[docs]</a>  <span class="k">def</span> <span class="nf">tan</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>     <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;tan&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.acos"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.acos">[docs]</a>  <span class="k">def</span> <span class="nf">acos</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>    <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;acos&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.asin"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.asin">[docs]</a>  <span class="k">def</span> <span class="nf">asin</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>    <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;asin&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.atan"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.atan">[docs]</a>  <span class="k">def</span> <span class="nf">atan</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>    <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;atan&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.cosh"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.cosh">[docs]</a>  <span class="k">def</span> <span class="nf">cosh</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>    <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;cosh&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.sinh"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.sinh">[docs]</a>  <span class="k">def</span> <span class="nf">sinh</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>    <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;sinh&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.tanh"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.tanh">[docs]</a>  <span class="k">def</span> <span class="nf">tanh</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>    <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;tanh&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.acosh"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.acosh">[docs]</a>  <span class="k">def</span> <span class="nf">acosh</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>   <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;acosh&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.asinh"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.asinh">[docs]</a>  <span class="k">def</span> <span class="nf">asinh</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>   <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;asinh&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.atanh"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.atanh">[docs]</a>  <span class="k">def</span> <span class="nf">atanh</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>   <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;atanh&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.cospi"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.cospi">[docs]</a>  <span class="k">def</span> <span class="nf">cospi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>   <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;cospi&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.sinpi"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.sinpi">[docs]</a>  <span class="k">def</span> <span class="nf">sinpi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>   <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;sinpi&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.tanpi"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.tanpi">[docs]</a>  <span class="k">def</span> <span class="nf">tanpi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>   <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;tanpi&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.abs"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.abs">[docs]</a>  <span class="k">def</span> <span class="nf">abs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>     <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;abs&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.sign"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.sign">[docs]</a>  <span class="k">def</span> <span class="nf">sign</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>    <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;sign&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.sqrt"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.sqrt">[docs]</a>  <span class="k">def</span> <span class="nf">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>    <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;sqrt&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.trunc"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.trunc">[docs]</a>  <span class="k">def</span> <span class="nf">trunc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>   <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;trunc&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.ceil"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.ceil">[docs]</a>  <span class="k">def</span> <span class="nf">ceil</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>    <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;ceiling&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.floor"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.floor">[docs]</a>  <span class="k">def</span> <span class="nf">floor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>   <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;floor&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.log"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.log">[docs]</a>  <span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>     <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;log&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.log10"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.log10">[docs]</a>  <span class="k">def</span> <span class="nf">log10</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>   <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;log10&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.log1p"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.log1p">[docs]</a>  <span class="k">def</span> <span class="nf">log1p</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>   <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;log1p&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.log2"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.log2">[docs]</a>  <span class="k">def</span> <span class="nf">log2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>    <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;log2&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.exp"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.exp">[docs]</a>  <span class="k">def</span> <span class="nf">exp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>     <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;exp&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.expm1"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.expm1">[docs]</a>  <span class="k">def</span> <span class="nf">expm1</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>   <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;expm1&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.gamma"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.gamma">[docs]</a>  <span class="k">def</span> <span class="nf">gamma</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>   <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;gamma&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.lgamma"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.lgamma">[docs]</a>  <span class="k">def</span> <span class="nf">lgamma</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;lgamma&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.digamma"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.digamma">[docs]</a>  <span class="k">def</span> <span class="nf">digamma</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;digamma&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>
<div class="viewcode-block" id="H2OFrame.trigamma"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.trigamma">[docs]</a>  <span class="k">def</span> <span class="nf">trigamma</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;trigamma&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>


<div class="viewcode-block" id="H2OFrame.diff"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.diff">[docs]</a>  <span class="k">def</span> <span class="nf">diff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      The lag1 difference for a numeric column (expects operation to occur over H2OFrame</span>
<span class="sd">      of a single column).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;difflag1&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span></div>

  <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="H2OFrame.mktime"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.mktime">[docs]</a>  <span class="k">def</span> <span class="nf">mktime</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">1970</span><span class="p">,</span><span class="n">month</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">day</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">hour</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">minute</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">second</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">msec</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;All units are zero-based (including months and days).</span>
<span class="sd">    Missing year is 1970.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      year : int, H2OFrame</span>
<span class="sd">      month: int, H2OFrame</span>
<span class="sd">      day : int, H2OFrame</span>
<span class="sd">      hour : int, H2OFrame</span>
<span class="sd">      minute : int, H2OFrame</span>
<span class="sd">      second : int, H2OFrame</span>
<span class="sd">      msec : int, H2OFrame</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame of one column containing the date in millis since the epoch.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;mktime&quot;</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span><span class="n">month</span><span class="p">,</span><span class="n">day</span><span class="p">,</span><span class="n">hour</span><span class="p">,</span><span class="n">minute</span><span class="p">,</span><span class="n">second</span><span class="p">,</span><span class="n">msec</span><span class="p">)</span><span class="o">.</span><span class="n">_eager_frame</span><span class="p">()</span></div>

<div class="viewcode-block" id="H2OFrame.unique"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.unique">[docs]</a>  <span class="k">def</span> <span class="nf">unique</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract the unique values in the column.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame of just the unique values in the column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;unique&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span></div>

<div class="viewcode-block" id="H2OFrame.levels"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.levels">[docs]</a>  <span class="k">def</span> <span class="nf">levels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the factor levels.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A list of lists, one list per column, of levels. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lol</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;levels&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span><span class="o">.</span><span class="n">as_data_frame</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">lol</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c"># Remove column headers</span>
    <span class="n">lol</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">lol</span><span class="p">))</span>
    <span class="n">lol</span> <span class="o">=</span> <span class="p">[[</span><span class="n">ll</span> <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="n">l</span><span class="p">]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lol</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">lol</span></div>

<div class="viewcode-block" id="H2OFrame.nlevels"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.nlevels">[docs]</a>  <span class="k">def</span> <span class="nf">nlevels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the number of factor levels for this frame.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A list of the number of levels per column. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">]</span> <span class="k">if</span> <span class="n">levels</span> <span class="k">else</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="H2OFrame.set_level"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.set_level">[docs]</a>  <span class="k">def</span> <span class="nf">set_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A method to set all column values to one of the levels.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    level : str</span>
<span class="sd">      The level at which the column will be set (a string)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame with entries set to the desired level.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;setLevel&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>

<div class="viewcode-block" id="H2OFrame.set_levels"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.set_levels">[docs]</a>  <span class="k">def</span> <span class="nf">set_levels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">levels</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Works on a single categorical column.</span>
<span class="sd">    New domains must be aligned with the old domains. This call has copy-on-write semantics.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    levels : list</span>
<span class="sd">      A list of strings specifying the new levels. The number of new levels must match</span>
<span class="sd">      the number of old levels.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A single-column H2OFrame with the desired levels.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;setDomain&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">levels</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>

<div class="viewcode-block" id="H2OFrame.set_names"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.set_names">[docs]</a>  <span class="k">def</span> <span class="nf">set_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">names</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Change all of this H2OFrame instance&#39;s column names.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      names : list</span>
<span class="sd">        A list of strings equal to the number of columns in the H2OFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span> <span class="o">=</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;colnames=&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncol</span><span class="p">),</span> <span class="n">names</span><span class="p">)</span>  <span class="c"># Update-in-place, but still lazy</span>
    <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="H2OFrame.set_name"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.set_name">[docs]</a>  <span class="k">def</span> <span class="nf">set_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set the name of the column at the specified index.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    col : int, str</span>
<span class="sd">      Index of the column whose name is to be set; may be skipped for 1-column frames</span>
<span class="sd">    name : str</span>
<span class="sd">      The new name of the column to set</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      Returns self.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span> <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>  <span class="c"># lookup the name</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;`col` must be an index. Got: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">col</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">col</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">old_cache</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span> <span class="o">=</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;colnames=&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">col</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>  <span class="c"># Update-in-place, but still lazy</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">fill_from</span><span class="p">(</span><span class="n">old_cache</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_frame</span><span class="p">()</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">fill</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[:</span><span class="n">col</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">col</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span></div>

<div class="viewcode-block" id="H2OFrame.as_date"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.as_date">[docs]</a>  <span class="k">def</span> <span class="nf">as_date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">format</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the column with all elements converted to millis since the epoch.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      format : str</span>
<span class="sd">        A datetime format string (e.g. &quot;YYYY-mm-dd&quot;)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      An H2OFrame instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;as.Date&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">format</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types_valid</span><span class="p">():</span>
      <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="s">&quot;int&quot;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>
    <span class="k">return</span> <span class="n">fr</span></div>

<div class="viewcode-block" id="H2OFrame.cumsum"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.cumsum">[docs]</a>  <span class="k">def</span> <span class="nf">cumsum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      The cumulative sum over the column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;cumsum&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>

<div class="viewcode-block" id="H2OFrame.cumprod"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.cumprod">[docs]</a>  <span class="k">def</span> <span class="nf">cumprod</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      The cumulative product over the column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;cumprod&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>

<div class="viewcode-block" id="H2OFrame.cummin"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.cummin">[docs]</a>  <span class="k">def</span> <span class="nf">cummin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      The cumulative min over the column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;cummin&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>

<div class="viewcode-block" id="H2OFrame.cummax"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.cummax">[docs]</a>  <span class="k">def</span> <span class="nf">cummax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      The cumulative max over the column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;cummax&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>

<div class="viewcode-block" id="H2OFrame.prod"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.prod">[docs]</a>  <span class="k">def</span> <span class="nf">prod</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">na_rm</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      na_rm : bool, default=False</span>
<span class="sd">        True or False to remove NAs from computation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      The product of the column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;prod.na&quot;</span> <span class="k">if</span> <span class="n">na_rm</span> <span class="k">else</span> <span class="s">&quot;prod&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_eager_scalar</span><span class="p">()</span></div>

<div class="viewcode-block" id="H2OFrame.any"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.any">[docs]</a>  <span class="k">def</span> <span class="nf">any</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      True if any element is True or NA in the column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;any&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_eager_scalar</span><span class="p">())</span></div>

<div class="viewcode-block" id="H2OFrame.any_na_rm"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.any_na_rm">[docs]</a>  <span class="k">def</span> <span class="nf">any_na_rm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      True if any element is True in the column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;any.na&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_eager_scalar</span><span class="p">())</span></div>

<div class="viewcode-block" id="H2OFrame.all"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.all">[docs]</a>  <span class="k">def</span> <span class="nf">all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      True if every element is True or NA in the column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;all&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_eager_scalar</span><span class="p">())</span></div>

<div class="viewcode-block" id="H2OFrame.isnumeric"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.isnumeric">[docs]</a>  <span class="k">def</span> <span class="nf">isnumeric</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      True if the column is numeric, otherwise return False</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types_valid</span><span class="p">():</span>
      <span class="k">return</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">itervalues</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;numeric&quot;</span><span class="p">,</span> <span class="s">&quot;int&quot;</span><span class="p">,</span> <span class="s">&quot;real&quot;</span><span class="p">]]</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">bool</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;is.numeric&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_eager_scalar</span><span class="p">()]</span></div>

<div class="viewcode-block" id="H2OFrame.isstring"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.isstring">[docs]</a>  <span class="k">def</span> <span class="nf">isstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      True if the column is a string column, otherwise False (same as ischaracter)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span>  <span class="p">[</span><span class="nb">bool</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;is.character&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_eager_scalar</span><span class="p">()]</span></div>

<div class="viewcode-block" id="H2OFrame.ischaracter"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.ischaracter">[docs]</a>  <span class="k">def</span> <span class="nf">ischaracter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      True if the column is a character column, otherwise False (same as isstring)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">isstring</span><span class="p">()</span></div>
  
<div class="viewcode-block" id="H2OFrame.isin"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.isin">[docs]</a>  <span class="k">def</span> <span class="nf">isin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test whether elements of an H2OFrame are contained in the item.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      items : any element or a list of elements</span>
<span class="sd">        An item or a list of items to compare the H2OFrame against.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      An H2OFrame of 0s and 1s showing whether each element in the original H2OFrame is contained in item.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">reduce</span><span class="p">(</span><span class="n">H2OFrame</span><span class="o">.</span><span class="n">__or__</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span> <span class="o">==</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">item</span><span class="p">))</span> <span class="k">if</span> <span class="n">_is_list</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">item</span></div>
  
<div class="viewcode-block" id="H2OFrame.kfold_column"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.kfold_column">[docs]</a>  <span class="k">def</span> <span class="nf">kfold_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_folds</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">seed</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Build a fold assignments column for cross-validation. This call will produce a</span>
<span class="sd">    column having the same data layout as the calling object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      n_folds : int</span>
<span class="sd">        An integer specifying the number of validation sets to split the training data</span>
<span class="sd">        into.</span>
<span class="sd">      seed : int, optional</span>
<span class="sd">        Seed for random numbers as fold IDs are randomly assigned.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A single column H2OFrame with the fold assignments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;kfold_column&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">n_folds</span><span class="p">,</span><span class="n">seed</span><span class="p">))</span><span class="o">.</span><span class="n">_frame</span><span class="p">()</span>  <span class="c"># want this to be eager!</span></div>

<div class="viewcode-block" id="H2OFrame.modulo_kfold_column"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.modulo_kfold_column">[docs]</a>  <span class="k">def</span> <span class="nf">modulo_kfold_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_folds</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Build a fold assignments column for cross-validation. Rows are assigned a fold</span>
<span class="sd">    according to the current row number modulo n_folds.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      n_folds : int</span>
<span class="sd">        An integer specifying the number of validation sets to split the training data</span>
<span class="sd">        into.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A single column H2OFrame with the fold assignments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;modulo_kfold_column&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">n_folds</span><span class="p">))</span><span class="o">.</span><span class="n">_frame</span><span class="p">()</span>  <span class="c"># want this to be eager!</span></div>

<div class="viewcode-block" id="H2OFrame.stratified_kfold_column"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.stratified_kfold_column">[docs]</a>  <span class="k">def</span> <span class="nf">stratified_kfold_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_folds</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">seed</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Build a fold assignment column with the constraint that each fold has the same class</span>
<span class="sd">    distribution as the fold column.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      n_folds: int</span>
<span class="sd">        The number of folds to build.</span>
<span class="sd">      seed: int</span>
<span class="sd">        A random seed.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A single column H2OFrame with the fold assignments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;stratified_kfold_column&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">n_folds</span><span class="p">,</span><span class="n">seed</span><span class="p">))</span><span class="o">.</span><span class="n">_frame</span><span class="p">()</span>  <span class="c"># want this to be eager!</span></div>

<div class="viewcode-block" id="H2OFrame.structure"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.structure">[docs]</a>  <span class="k">def</span> <span class="nf">structure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Similar to R&#39;s str method: Compactly Display the Structure of this H2OFrame.&quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_data_frame</span><span class="p">(</span><span class="n">use_pandas</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">cn</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">nr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span>
    <span class="n">nc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span>
    <span class="n">width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cn</span><span class="p">])</span>
    <span class="n">isfactor</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">isfactor</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]</span>
    <span class="n">numlevels</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlevels</span><span class="p">()</span>
    <span class="n">lvls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;self._newExpr &#39;{}&#39;: </span><span class="se">\t</span><span class="s"> {} obs. of {} variables(s)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span><span class="p">,</span><span class="n">nr</span><span class="p">,</span><span class="n">nc</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
      <span class="k">print</span><span class="p">(</span><span class="s">&quot;$ {} {}: &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cn</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s">&#39; &#39;</span><span class="o">*</span><span class="p">(</span><span class="n">width</span><span class="o">-</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">cn</span><span class="p">[</span><span class="n">i</span><span class="p">])))),</span> <span class="n">end</span><span class="o">=</span><span class="s">&#39; &#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">isfactor</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
        <span class="n">nl</span> <span class="o">=</span> <span class="n">numlevels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Factor w/ {} level(s) {}: &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nl</span><span class="p">,</span> <span class="s">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s">&#39;&quot;,&quot;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lvls</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s">&#39;&quot;&#39;</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s">&#39; &#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">lvls</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">df</span><span class="p">))[</span><span class="n">i</span><span class="p">]))))</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;num {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">it</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">h2o</span><span class="o">.</span><span class="n">as_list</span><span class="p">(</span><span class="bp">self</span><span class="p">[:</span><span class="mi">10</span><span class="p">,</span><span class="n">i</span><span class="p">],</span> <span class="bp">False</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])))</span></div>

<div class="viewcode-block" id="H2OFrame.as_data_frame"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.as_data_frame">[docs]</a>  <span class="k">def</span> <span class="nf">as_data_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_pandas</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Obtain the dataset as a python-local object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      use_pandas : bool, default=True</span>
<span class="sd">        A flag specifying whether or not to return a pandas DataFrame.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A local python object (a list of lists of strings, each list is a row, if</span>
<span class="sd">      use_pandas=False, otherwise a pandas DataFrame) containing this H2OFrame instance&#39;s</span>
<span class="sd">      data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">can_use_pandas</span><span class="p">()</span> <span class="ow">and</span> <span class="n">use_pandas</span><span class="p">:</span>
      <span class="kn">import</span> <span class="nn">pandas</span>
      <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_frame_data</span><span class="p">()),</span> <span class="n">low_memory</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">row</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_frame_data</span><span class="p">()))]</span></div>

<div class="viewcode-block" id="H2OFrame.get_frame_data"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.get_frame_data">[docs]</a>  <span class="k">def</span> <span class="nf">get_frame_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get frame data as str in csv format</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A local python string, each line is a row and each element separated by commas,</span>
<span class="sd">      containing this H2OFrame instance&#39;s data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">H2OConnection</span><span class="o">.</span><span class="n">make_url</span><span class="p">(</span><span class="s">&quot;DownloadDataset&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;?frame_id={}&amp;hex_string=false&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s">&#39;H2O Python client/&#39;</span><span class="o">+</span><span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)},</span>
                        <span class="n">auth</span> <span class="o">=</span> <span class="p">(</span><span class="n">H2OConnection</span><span class="o">.</span><span class="n">username</span><span class="p">(),</span> <span class="n">H2OConnection</span><span class="o">.</span><span class="n">password</span><span class="p">()),</span>
                        <span class="n">verify</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">H2OConnection</span><span class="o">.</span><span class="n">insecure</span><span class="p">(),</span> <span class="n">stream</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">text</span></div>

<div class="viewcode-block" id="H2OFrame.flatten"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.flatten">[docs]</a>  <span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;flatten&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_eager_scalar</span><span class="p">()</span></div>

  <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Frame slicing. Supports R-like row and column slicing.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      item : tuple, list, string, int</span>
<span class="sd">         If a tuple, then this indicates both row and column selection. The tuple</span>
<span class="sd">         must be exactly length 2.</span>
<span class="sd">         If a list, then this indicates column selection.</span>
<span class="sd">         If a int, the this indicates a single column to be retrieved at the index.</span>
<span class="sd">         If a string, then slice on the column with this name.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      An instance of H2OFrame.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">      fr[2]              # All rows, column 2</span>
<span class="sd">      fr[-2]             # All rows, 2nd column from end</span>
<span class="sd">      fr[:,-1]           # All rows, last column</span>
<span class="sd">      fr[0:5,:]          # first 5 rows, all columns</span>
<span class="sd">      fr[fr[0] &gt; 1, :]   # all rows greater than 1 in the first column, all columns</span>
<span class="sd">      fr[[1,5,6]]        # columns 1, 5, and 6</span>
<span class="sd">      fr[0:50, [1,2,3]]  # first 50 rows, columns 1,2, and 3</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># Select columns based on a string, a list of strings, an int or a slice.</span>
    <span class="c"># Note that the python column selector handles the case of negative</span>
    <span class="c"># selections, or out-of-range selections - without having to compute</span>
    <span class="c"># self._ncols in the front-end - which would force eager evaluation just to</span>
    <span class="c"># range check in the front-end.</span>
    <span class="n">new_ncols</span><span class="o">=-</span><span class="mi">1</span>
    <span class="n">new_nrows</span><span class="o">=-</span><span class="mi">1</span>
    <span class="n">new_names</span><span class="o">=</span><span class="bp">None</span>
    <span class="n">new_types</span><span class="o">=</span><span class="bp">None</span>
    <span class="n">fr</span><span class="o">=</span><span class="bp">None</span>
    <span class="n">flatten</span><span class="o">=</span><span class="bp">False</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="p">(</span><span class="nb">basestring</span><span class="p">,</span><span class="nb">list</span><span class="p">,</span><span class="nb">int</span><span class="p">,</span><span class="nb">slice</span><span class="p">)):</span>
      <span class="n">new_ncols</span><span class="p">,</span><span class="n">new_names</span><span class="p">,</span><span class="n">new_types</span><span class="p">,</span><span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_ncol_update</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
      <span class="n">new_nrows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span>
      <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;cols_py&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">item</span><span class="p">))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="p">(</span><span class="n">ExprNode</span><span class="p">,</span> <span class="n">H2OFrame</span><span class="p">)):</span>
      <span class="n">new_ncols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span>
      <span class="n">new_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span>
      <span class="n">new_types</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span>
      <span class="n">new_nrows</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c"># have a &quot;big&quot; predicate column -- update cache later on...</span>
      <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;rows&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">item</span><span class="p">))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
      <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">item</span>
      <span class="n">allrows</span> <span class="o">=</span> <span class="n">allcols</span> <span class="o">=</span> <span class="bp">False</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>  <span class="n">allcols</span> <span class="o">=</span> <span class="nb">all</span><span class="p">([</span><span class="n">a</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="n">cols</span><span class="o">.</span><span class="n">start</span><span class="p">,</span><span class="n">cols</span><span class="o">.</span><span class="n">step</span><span class="p">,</span><span class="n">cols</span><span class="o">.</span><span class="n">stop</span><span class="p">]])</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>  <span class="n">allrows</span> <span class="o">=</span> <span class="nb">all</span><span class="p">([</span><span class="n">a</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="n">rows</span><span class="o">.</span><span class="n">start</span><span class="p">,</span><span class="n">rows</span><span class="o">.</span><span class="n">step</span><span class="p">,</span><span class="n">rows</span><span class="o">.</span><span class="n">stop</span><span class="p">]])</span>

      <span class="k">if</span> <span class="n">allrows</span> <span class="ow">and</span> <span class="n">allcols</span><span class="p">:</span> <span class="k">return</span> <span class="bp">self</span>               <span class="c"># fr[:,:]    -&gt; all rows and columns.. return self</span>
      <span class="k">if</span> <span class="n">allrows</span><span class="p">:</span>
        <span class="n">new_ncols</span><span class="p">,</span><span class="n">new_names</span><span class="p">,</span><span class="n">new_types</span><span class="p">,</span><span class="n">cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_ncol_update</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
        <span class="n">new_nrows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span>
        <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;cols_py&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">cols</span><span class="p">))</span>  <span class="c"># fr[:,cols] -&gt; really just a column slice</span>
      <span class="k">if</span> <span class="n">allcols</span><span class="p">:</span>
        <span class="n">new_ncols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span>
        <span class="n">new_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span>
        <span class="n">new_types</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span>
        <span class="n">new_nrows</span><span class="p">,</span><span class="n">rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_nrow_update</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
        <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;rows&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">rows</span><span class="p">))</span>  <span class="c"># fr[rows,:] -&gt; really just a row slices</span>

      <span class="k">if</span> <span class="ow">not</span> <span class="n">allrows</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">allcols</span><span class="p">:</span>
        <span class="n">new_ncols</span><span class="p">,</span><span class="n">new_names</span><span class="p">,</span><span class="n">new_types</span><span class="p">,</span><span class="n">cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_ncol_update</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
        <span class="n">new_nrows</span><span class="p">,</span><span class="n">rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_nrow_update</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
        <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;rows&quot;</span><span class="p">,</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;cols_py&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">cols</span><span class="p">),</span><span class="n">rows</span><span class="p">))</span>

      <span class="n">flatten</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="p">(</span><span class="nb">basestring</span><span class="p">,</span><span class="nb">int</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Unexpected __getitem__ selector: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">))</span><span class="o">+</span><span class="s">&quot; &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">__class__</span><span class="p">))</span>

    <span class="k">assert</span> <span class="n">fr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
    <span class="c"># Pythonic: if the row &amp; col selector turn into ints (or a single col</span>
    <span class="c"># name), then extract the single element out of the Frame.  Otherwise</span>
    <span class="c"># return a Frame, EVEN IF the selectors are e.g. slices-of-1-value.</span>
    <span class="k">if</span> <span class="n">flatten</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">fr</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">ncols</span> <span class="o">=</span> <span class="n">new_ncols</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">nrows</span> <span class="o">=</span> <span class="n">new_nrows</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">new_names</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="n">new_types</span>
    <span class="k">return</span> <span class="n">fr</span>

  <span class="k">def</span> <span class="nf">_compute_ncol_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>  <span class="c"># computes new ncol, names, and types</span>
    <span class="k">try</span> <span class="p">:</span>
      <span class="n">new_ncols</span><span class="o">=-</span><span class="mi">1</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">new_ncols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_is_str_list</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
          <span class="n">new_types</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">item</span><span class="p">}</span>
          <span class="n">new_names</span> <span class="o">=</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">new_names</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">item</span><span class="p">]</span>
          <span class="n">new_types</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">new_names</span><span class="p">}</span>
      <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">item</span><span class="o">.</span><span class="n">start</span>
        <span class="n">end</span>   <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span> <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">stop</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">item</span><span class="o">.</span><span class="n">stop</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">end</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
          <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span><span class="o">+</span><span class="n">end</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">item</span><span class="o">.</span><span class="n">stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
          <span class="n">new_ncols</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>
        <span class="n">range_list</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">end</span><span class="p">)</span>
        <span class="n">new_names</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">range_list</span><span class="p">]</span>
        <span class="n">new_types</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">new_names</span><span class="p">}</span>
        <span class="n">item</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">end</span><span class="p">)</span>
      <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="p">(</span><span class="nb">basestring</span><span class="p">,</span><span class="nb">int</span><span class="p">)):</span>
        <span class="n">new_ncols</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span>
          <span class="n">new_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">]</span>
          <span class="n">new_types</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span> <span class="k">else</span> <span class="p">{</span><span class="n">item</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="n">item</span><span class="p">]}</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">new_names</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">item</span><span class="p">]]</span>
          <span class="n">new_types</span> <span class="o">=</span> <span class="p">{</span><span class="n">new_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="n">new_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]]}</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Unexpected type: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)))</span>
      <span class="k">return</span> <span class="p">[</span><span class="n">new_ncols</span><span class="p">,</span><span class="n">new_names</span><span class="p">,</span><span class="n">new_types</span><span class="p">,</span><span class="n">item</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
      <span class="k">return</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="n">item</span><span class="p">]</span>

  <span class="k">def</span> <span class="nf">_compute_nrow_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">new_nrows</span><span class="o">=-</span><span class="mi">1</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">new_nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
      <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">item</span><span class="o">.</span><span class="n">start</span>
        <span class="n">end</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span> <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">stop</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">item</span><span class="o">.</span><span class="n">stop</span>
        <span class="k">if</span> <span class="n">end</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
          <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span><span class="o">+</span><span class="n">end</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">item</span><span class="o">.</span><span class="n">stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
          <span class="n">new_nrows</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>
        <span class="n">item</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">end</span><span class="p">)</span>
      <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">H2OFrame</span><span class="p">):</span>
        <span class="n">new_nrows</span><span class="o">=-</span><span class="mi">1</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">new_nrows</span><span class="o">=</span><span class="mi">1</span>
      <span class="k">return</span> <span class="p">[</span><span class="n">new_nrows</span><span class="p">,</span><span class="n">item</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
      <span class="k">return</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">item</span><span class="p">]</span>

  <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Replace or update column(s) in an H2OFrame.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      b : int, str</span>
<span class="sd">        A 0-based index or a column name.</span>
<span class="sd">      c :</span>
<span class="sd">        The value replacing &#39;b&#39;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      Returns this H2OFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">col_expr</span><span class="o">=</span><span class="bp">None</span>
    <span class="n">row_expr</span><span class="o">=</span><span class="bp">None</span>
    <span class="n">colname</span><span class="o">=</span><span class="bp">None</span>  <span class="c"># When set, we are doing an append</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span>  <span class="c"># String column name, could be new or old</span>
      <span class="k">if</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
        <span class="n">col_expr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>  <span class="c"># Old, update</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">col_expr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span>
        <span class="n">colname</span> <span class="o">=</span> <span class="n">b</span>  <span class="c"># New, append</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>    <span class="n">col_expr</span> <span class="o">=</span> <span class="n">b</span>  <span class="c"># Column by number</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>     <span class="c"># Both row and col specifiers</span>
      <span class="n">row_expr</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
      <span class="n">col_expr</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col_expr</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span>    <span class="c"># Col by name</span>
        <span class="k">if</span> <span class="n">col_expr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>  <span class="c"># Append</span>
          <span class="n">colname</span> <span class="o">=</span> <span class="n">col_expr</span>
          <span class="n">col_expr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span>
      <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col_expr</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>    <span class="c"># Col by slice</span>
        <span class="k">if</span> <span class="n">col_expr</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">col_expr</span><span class="o">.</span><span class="n">stop</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
          <span class="n">col_expr</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ncol</span><span class="p">)</span>    <span class="c"># Slice of all</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="p">(</span><span class="n">ExprNode</span><span class="p">,</span> <span class="n">H2OFrame</span><span class="p">)):</span> <span class="n">row_expr</span> <span class="o">=</span> <span class="n">b</span> <span class="c"># Row slicing</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span> <span class="n">col_expr</span> <span class="o">=</span> <span class="n">b</span>

    <span class="n">src</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s">&quot;nan&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">c</span>
    <span class="n">src_in_self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_src_in_self</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
    <span class="n">old_cache</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span>
    <span class="k">if</span> <span class="n">colname</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span> <span class="o">=</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;:=&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">src</span><span class="p">,</span><span class="n">col_expr</span><span class="p">,</span><span class="n">row_expr</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">fill_from</span><span class="p">(</span><span class="n">old_cache</span><span class="p">)</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">H2OFrame</span><span class="p">)</span>    <span class="ow">and</span> \
        <span class="n">src</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types_valid</span><span class="p">()</span>  <span class="ow">and</span> \
        <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types_valid</span><span class="p">():</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">_types</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span> <span class="o">=</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;append&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">src</span><span class="p">,</span><span class="n">colname</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">fill_from</span><span class="p">(</span><span class="n">old_cache</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">+</span> <span class="p">[</span><span class="n">colname</span><span class="p">]</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types_valid</span><span class="p">()</span> <span class="ow">or</span> \
         <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">H2OFrame</span><span class="p">)</span>     <span class="ow">or</span> \
         <span class="ow">not</span> <span class="n">src</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types_valid</span><span class="p">():</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="bp">None</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">_types</span><span class="p">[</span><span class="n">colname</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itervalues</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">H2OFrame</span><span class="p">)</span> <span class="ow">and</span> <span class="n">src_in_self</span><span class="p">:</span>
      <span class="n">src</span><span class="o">.</span><span class="n">_ex</span><span class="o">=</span><span class="bp">None</span>  <span class="c"># wipe out to keep ref counts correct</span>
    <span class="c"># self._frame()  # setitem is eager</span>

<div class="viewcode-block" id="H2OFrame.is_src_in_self"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.is_src_in_self">[docs]</a>  <span class="k">def</span> <span class="nf">is_src_in_self</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">src</span><span class="p">):</span></div>
    <span class="c"># src._ex._children[0]._children[0] is self._ex</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">H2OFrame</span><span class="p">):</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span> <span class="ow">is</span> <span class="n">src</span><span class="o">.</span><span class="n">_ex</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">src</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_children</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
          <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">src</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_children</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_src_in_self</span><span class="p">(</span><span class="n">ch</span><span class="p">):</span> <span class="k">return</span> <span class="bp">True</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">ExprNode</span><span class="p">):</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span> <span class="ow">is</span> <span class="n">src</span><span class="p">:</span> <span class="k">return</span> <span class="bp">True</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">src</span><span class="o">.</span><span class="n">_children</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
          <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">src</span><span class="o">.</span><span class="n">_children</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_src_in_self</span><span class="p">(</span><span class="n">ch</span><span class="p">):</span> <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>

  <span class="k">def</span> <span class="nf">__int__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Not a 1x1 Frame&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>

  <span class="k">def</span> <span class="nf">__float__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Not a 1x1 Frame&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>

<div class="viewcode-block" id="H2OFrame.drop"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.drop">[docs]</a>  <span class="k">def</span> <span class="nf">drop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Drop a column from the current H2OFrame.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      i : str, int</span>
<span class="sd">        The column to be dropped</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame with the column at index i dropped. Returns a new H2OFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span> <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;cols&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span><span class="o">-</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">ncols</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">names</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">fr</span></div>

<div class="viewcode-block" id="H2OFrame.pop"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.pop">[docs]</a>  <span class="k">def</span> <span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Pop a column from the H2OFrame at index i</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    i : int, str</span>
<span class="sd">      The index or name of the column to pop.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      The column dropped from the frame; the frame is side-effected to lose the column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span> <span class="n">i</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;cols&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">))</span>
    <span class="n">old_cache</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span> <span class="o">=</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;cols&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span><span class="o">-</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">ncols</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">old_cache</span><span class="o">.</span><span class="n">names</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">old_cache</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span><span class="n">old_cache</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">names</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">col</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">ncols</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">col</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">old_cache</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">col</span></div>

<div class="viewcode-block" id="H2OFrame.quantile"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.quantile">[docs]</a>  <span class="k">def</span> <span class="nf">quantile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">combine_method</span><span class="o">=</span><span class="s">&quot;interpolate&quot;</span><span class="p">,</span> <span class="n">weights_column</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute quantiles.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    prob : list, default=[0.01,0.1,0.25,0.333,0.5,0.667,0.75,0.9,0.99]</span>
<span class="sd">      A list of probabilities of any length.</span>
<span class="sd">    combine_method : str, default=&quot;interpolate&quot;</span>
<span class="sd">      For even samples, how to combine quantiles.</span>
<span class="sd">      Should be one of [&quot;interpolate&quot;, &quot;average&quot;, &quot;low&quot;, &quot;hi&quot;]</span>
<span class="sd">    weights_column : str, default=None</span>
<span class="sd">      Name of column with optional observation weights in this H2OFrame or a 1-column H2OFrame of observation weights.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A new H2OFrame containing the quantiles and probabilities.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="bp">self</span>
    <span class="k">if</span> <span class="n">prob</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">prob</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.333</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.667</span><span class="p">,</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.99</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">weights_column</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">weights_column</span><span class="o">=</span><span class="s">&quot;_&quot;</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">weights_column</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">weights_column</span><span class="p">,</span> <span class="n">H2OFrame</span><span class="p">)</span> 
                                                        <span class="ow">and</span> <span class="n">weights_column</span><span class="o">.</span><span class="n">ncol</span> <span class="o">==</span> <span class="mi">1</span> 
                                                        <span class="ow">and</span> <span class="n">weights_column</span><span class="o">.</span><span class="n">nrow</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;`weights_column` must be a column name in x or an H2OFrame object with 1 column and same row count as x&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">weights_column</span><span class="p">,</span> <span class="n">H2OFrame</span><span class="p">):</span>
        <span class="n">merged</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">weights_column</span><span class="p">)</span>
        <span class="n">weights_column</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;quantile&quot;</span><span class="p">,</span><span class="n">merged</span><span class="p">,</span><span class="n">prob</span><span class="p">,</span><span class="n">combine_method</span><span class="p">,</span><span class="n">weights_column</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;quantile&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">prob</span><span class="p">,</span><span class="n">combine_method</span><span class="p">,</span><span class="n">weights_column</span><span class="p">))</span></div>

<div class="viewcode-block" id="H2OFrame.cbind"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.cbind">[docs]</a>  <span class="k">def</span> <span class="nf">cbind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Append data to this H2OFrame column-wise.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : H2OFrame</span>
<span class="sd">      H2OFrame to be column bound to the right of this H2OFrame.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame of the combined datasets.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;cbind&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">ncols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">ncol</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="bp">None</span>  <span class="c"># invalidate for possibly duplicate names</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="bp">None</span>  <span class="c"># invalidate for possibly duplicate names</span>
    <span class="k">return</span> <span class="n">fr</span></div>

<div class="viewcode-block" id="H2OFrame.rbind"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.rbind">[docs]</a>  <span class="k">def</span> <span class="nf">rbind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Combine H2O Datasets by rows.</span>
<span class="sd">    Takes a sequence of H2O data sets and combines them by rows.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      data : H2OFrame</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      Returns this H2OFrame with data appended row-wise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">H2OFrame</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;`data` must be an H2OFrame, but got {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;rbind&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">nrows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">nrow</span>
    <span class="k">return</span> <span class="n">fr</span></div>

<div class="viewcode-block" id="H2OFrame.split_frame"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.split_frame">[docs]</a>  <span class="k">def</span> <span class="nf">split_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ratios</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">destination_frames</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Split a frame into distinct subsets of size determined by the given ratios.</span>
<span class="sd">    The number of subsets is always 1 more than the number of ratios given.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      ratios : list</span>
<span class="sd">        The fraction of rows for each split.</span>
<span class="sd">      destination_frames : list</span>
<span class="sd">        The names of the split frames.</span>
<span class="sd">      seed : int</span>
<span class="sd">        Used for selecting which H2OFrame a row will belong to.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A list of H2OFrame instances</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">ratios</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="n">ratios</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ratios</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Ratios must have length of at least 1&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">destination_frames</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ratios</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">destination_frames</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The number of provided destination_frames must be one more than the number of provided ratios&quot;</span><span class="p">)</span>

    <span class="n">num_slices</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ratios</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">boundaries</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">last_boundary</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_slices</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
      <span class="n">ratio</span> <span class="o">=</span> <span class="n">ratios</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
      <span class="k">if</span> <span class="n">ratio</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Ratio must be greater than 0&quot;</span><span class="p">)</span>
      <span class="n">boundary</span> <span class="o">=</span> <span class="n">last_boundary</span> <span class="o">+</span> <span class="n">ratio</span>
      <span class="k">if</span> <span class="n">boundary</span> <span class="o">&gt;=</span> <span class="mf">1.0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Ratios must add up to less than 1.0&quot;</span><span class="p">)</span>
      <span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">boundary</span><span class="p">)</span>
      <span class="n">last_boundary</span> <span class="o">=</span> <span class="n">boundary</span>
      <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">splits</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tmp_runif</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runif</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_slices</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c"># lower_boundary is 0.0</span>
        <span class="n">upper_boundary</span> <span class="o">=</span> <span class="n">boundaries</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">tmp_slice</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[(</span><span class="n">tmp_runif</span> <span class="o">&lt;=</span> <span class="n">upper_boundary</span><span class="p">),</span> <span class="p">:]</span>
      <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="n">num_slices</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">lower_boundary</span> <span class="o">=</span> <span class="n">boundaries</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="c"># upper_boundary is 1.0</span>
        <span class="n">tmp_slice</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[(</span><span class="n">tmp_runif</span> <span class="o">&gt;</span> <span class="n">lower_boundary</span><span class="p">),</span> <span class="p">:]</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">lower_boundary</span> <span class="o">=</span> <span class="n">boundaries</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">upper_boundary</span> <span class="o">=</span> <span class="n">boundaries</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">tmp_slice</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[((</span><span class="n">tmp_runif</span> <span class="o">&gt;</span> <span class="n">lower_boundary</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">tmp_runif</span> <span class="o">&lt;=</span> <span class="n">upper_boundary</span><span class="p">)),</span> <span class="p">:]</span>

      <span class="k">if</span> <span class="n">destination_frames</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">splits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp_slice</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">destination_frame_id</span> <span class="o">=</span> <span class="n">destination_frames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">tmp_slice</span><span class="o">.</span><span class="n">frame_id</span> <span class="o">=</span> <span class="n">destination_frame_id</span>
        <span class="n">splits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp_slice</span><span class="p">)</span>

      <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">splits</span></div>

<div class="viewcode-block" id="H2OFrame.ddply"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.ddply">[docs]</a>  <span class="k">def</span> <span class="nf">ddply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cols</span><span class="p">,</span><span class="n">fun</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Unimplemented&quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;unimpl&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="H2OFrame.group_by"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.group_by">[docs]</a>  <span class="k">def</span> <span class="nf">group_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">by</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a new GroupBy object using this frame and the desired grouping columns.</span>
<span class="sd">       The returned groups are sorted by the natural group-by column sort.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    by : list</span>
<span class="sd">        The columns to group on.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A new GroupBy object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">GroupBy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">by</span><span class="p">)</span></div>

<div class="viewcode-block" id="H2OFrame.impute"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.impute">[docs]</a>  <span class="k">def</span> <span class="nf">impute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;mean&quot;</span><span class="p">,</span> <span class="n">combine_method</span><span class="o">=</span><span class="s">&quot;interpolate&quot;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">group_by_frame</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Impute in place.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    column: int, default=-1</span>
<span class="sd">        The column to impute, if -1 then impute the whole frame</span>
<span class="sd">    method : str, default=&quot;mean&quot;</span>
<span class="sd">        The method of imputation: mean, median, mode</span>
<span class="sd">    combine_method : str, default=&quot;interpolate&quot;</span>
<span class="sd">        When method is &quot;median&quot;, dictates how to combine quantiles for even samples.</span>
<span class="sd">    by : list, default=None</span>
<span class="sd">        The columns to group on.</span>
<span class="sd">    group_by_frame : H2OFrame, default=None</span>
<span class="sd">        Impute the column col with this pre-computed grouped frame.</span>
<span class="sd">    values : list</span>
<span class="sd">        A list of impute values (one per column). NaN indicates to skip the column.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A list of values used in the imputation or the group by result used in imputation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span> <span class="n">column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span>     <span class="n">by</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">by</span><span class="p">)</span>


    <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">values</span><span class="o">=</span><span class="s">&quot;_&quot;</span>
    <span class="k">if</span> <span class="n">group_by_frame</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">group_by_frame</span><span class="o">=</span><span class="s">&quot;_&quot;</span>

    <span class="k">if</span> <span class="n">by</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">group_by_frame</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s">&quot;_&quot;</span><span class="p">:</span>
      <span class="n">res</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;h2o.impute&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">combine_method</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">group_by_frame</span><span class="p">,</span> <span class="n">values</span><span class="p">))</span><span class="o">.</span><span class="n">_frame</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">res</span> <span class="o">=</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;h2o.impute&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">combine_method</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">group_by_frame</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">_eager_scalar</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">flush</span><span class="p">();</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span></div>

<div class="viewcode-block" id="H2OFrame.merge"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.merge">[docs]</a>  <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">all_x</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">all_y</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">by_x</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">by_y</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;auto&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Merge two datasets based on common column names</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    other: H2OFrame</span>
<span class="sd">      Other dataset to merge.  Must have at least one column in common with self,</span>
<span class="sd">      and all columns in common are used as the merge key.  If you want to use only a</span>
<span class="sd">      subset of the columns in common, rename the other columns so the columns are unique</span>
<span class="sd">      in the merged result.</span>
<span class="sd">    all_x: bool, default=False</span>
<span class="sd">      If True, include all rows from the left/self frame</span>
<span class="sd">    all_y: bool, default=False</span>
<span class="sd">      If True, include all rows from the right/other frame</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      Original self frame enhanced with merged columns and rows</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">common_names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="p">))</span>
    <span class="n">common_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">common_names</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">common_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;No columns in common to merge on!&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">by_x</span><span class="o">==</span><span class="bp">None</span><span class="p">):</span> <span class="n">by_x</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">common_names</span><span class="p">]</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">by_y</span><span class="o">==</span><span class="bp">None</span><span class="p">):</span> <span class="n">by_y</span> <span class="o">=</span> <span class="p">[</span><span class="n">other</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">common_names</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;merge&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">all_x</span><span class="p">,</span> <span class="n">all_y</span><span class="p">,</span> <span class="n">by_x</span><span class="p">,</span> <span class="n">by_y</span><span class="p">,</span> <span class="n">method</span><span class="p">))</span></div>

<div class="viewcode-block" id="H2OFrame.insert_missing_values"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.insert_missing_values">[docs]</a>  <span class="k">def</span> <span class="nf">insert_missing_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Inserting Missing Values into an H2OFrame.</span>
<span class="sd">    *This is primarily used for testing*.</span>

<span class="sd">    Randomly replaces a user-specified fraction of entries in a H2O dataset with missing</span>
<span class="sd">    values.</span>

<span class="sd">    WARNING: This will modify the original dataset.  Unless this is intended, this</span>
<span class="sd">    function should only be called on a subset of the original.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fraction : float</span>
<span class="sd">      A number between 0 and 1 indicating the fraction of entries to replace with missing.</span>
<span class="sd">    seed : int</span>
<span class="sd">      A random number used to select which entries to replace with missing values.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame with missing values inserted.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;dataset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_id</span>  <span class="c"># Eager; forces eval now for following REST call</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;fraction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fraction</span>
    <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;seed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">seed</span>
    <span class="n">job</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">job</span><span class="p">[</span><span class="s">&#39;job&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">H2OConnection</span><span class="o">.</span><span class="n">post_json</span><span class="p">(</span><span class="s">&quot;MissingInserter&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">H2OJob</span><span class="p">(</span><span class="n">job</span><span class="p">,</span> <span class="n">job_type</span><span class="o">=</span><span class="p">(</span><span class="s">&quot;Insert Missing Values&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="H2OFrame.min"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.min">[docs]</a>  <span class="k">def</span> <span class="nf">min</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      The minimum value of all frame entries</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;min&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_eager_scalar</span><span class="p">()</span></div>

<div class="viewcode-block" id="H2OFrame.max"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.max">[docs]</a>  <span class="k">def</span> <span class="nf">max</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      The maximum value of all frame entries</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;max&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_eager_scalar</span><span class="p">()</span></div>

<div class="viewcode-block" id="H2OFrame.sum"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.sum">[docs]</a>  <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">na_rm</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      The sum of all frame entries</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;sumNA&quot;</span> <span class="k">if</span> <span class="n">na_rm</span> <span class="k">else</span> <span class="s">&quot;sum&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_eager_scalar</span><span class="p">()</span></div>

<div class="viewcode-block" id="H2OFrame.mean"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.mean">[docs]</a>  <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">na_rm</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute the mean.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      na_rm: bool, default=False</span>
<span class="sd">        If True, then remove NAs from the computation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A list containing the mean for each column (NaN for non-numeric columns).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;mean&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">na_rm</span><span class="p">)</span><span class="o">.</span><span class="n">_eager_scalar</span><span class="p">()</span></div>

<div class="viewcode-block" id="H2OFrame.nacnt"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.nacnt">[docs]</a>  <span class="k">def</span> <span class="nf">nacnt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Count of NAs for each column in this H2OFrame.</span>

<span class="sd">      Returns</span>
<span class="sd">      -------</span>
<span class="sd">        A list of the na cnts (one entry per column).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;naCnt&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_eager_scalar</span><span class="p">()</span></div>

<div class="viewcode-block" id="H2OFrame.median"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.median">[docs]</a>  <span class="k">def</span> <span class="nf">median</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">na_rm</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute the median.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      na_rm: bool, default=False</span>
<span class="sd">        If True, then remove NAs from the computation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A list containing the median for each column (NaN for non-numeric columns).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;median&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">na_rm</span><span class="p">)</span><span class="o">.</span><span class="n">_eager_scalar</span><span class="p">()</span></div>

<div class="viewcode-block" id="H2OFrame.var"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.var">[docs]</a>  <span class="k">def</span> <span class="nf">var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">na_rm</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">use</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute the variance or covariance matrix of one or two H2OFrames.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : H2OFrame, default=None</span>
<span class="sd">      If y is None and self is a single column, then the variance is computed for self. If self has </span>
<span class="sd">      multiple columns, then its covariance matrix is returned. Single rows are treated as single columns. </span>
<span class="sd">      If y is not None, then a covariance matrix between the columns of self and the columns of y is computed. </span>
<span class="sd">    na_rm : bool, default=False</span>
<span class="sd">      Remove NAs from the computation.</span>
<span class="sd">    use : str, default=None, which acts as &quot;everything&quot; if na_rm is False, and &quot;complete.obs&quot; if na_rm is True</span>
<span class="sd">      A string indicating how to handle missing values. This must be one of the following: </span>
<span class="sd">        &quot;everything&quot;            - outputs NaNs whenever one of its contributing observations is missing</span>
<span class="sd">        &quot;all.obs&quot;               - presence of missing observations will throw an error</span>
<span class="sd">        &quot;complete.obs&quot;          - discards missing values along with all observations in their rows so that only complete observations are used</span>
<span class="sd">        &quot;pairwise.complete.obs&quot; - uses all complete pairs of observations</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      An H2OFrame of the covariance matrix of the columns of this H2OFrame with itself (if y is not given), or with the columns of y </span>
<span class="sd">      (if y is given). If self and y are single rows or single columns, the variance or covariance is given as a scalar.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">symmetric</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> 
      <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="n">symmetric</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">if</span> <span class="n">use</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">use</span> <span class="o">=</span> <span class="s">&quot;complete.obs&quot;</span> <span class="k">if</span> <span class="n">na_rm</span> <span class="k">else</span> <span class="s">&quot;everything&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span><span class="o">==</span><span class="mi">1</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncol</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">y</span><span class="o">.</span><span class="n">ncol</span><span class="o">==</span><span class="mi">1</span><span class="p">):</span> <span class="k">return</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;var&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">use</span><span class="p">,</span><span class="n">symmetric</span><span class="p">)</span><span class="o">.</span><span class="n">_eager_scalar</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;var&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">use</span><span class="p">,</span><span class="n">symmetric</span><span class="p">))</span><span class="o">.</span><span class="n">_frame</span><span class="p">()</span></div>

<div class="viewcode-block" id="H2OFrame.sd"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.sd">[docs]</a>  <span class="k">def</span> <span class="nf">sd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">na_rm</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute the standard deviation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    na_rm : bool, default=False</span>
<span class="sd">      Remove NAs from the computation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A list containing the standard deviation for each column (NaN for non-numeric</span>
<span class="sd">      columns).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;sd&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">na_rm</span><span class="p">)</span><span class="o">.</span><span class="n">_eager_scalar</span><span class="p">()</span></div>

<div class="viewcode-block" id="H2OFrame.asfactor"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.asfactor">[docs]</a>  <span class="k">def</span> <span class="nf">asfactor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2Oframe of one column converted to a factor.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;as.factor&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types_valid</span><span class="p">():</span>
      <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="p">{</span><span class="nb">list</span><span class="p">(</span><span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span><span class="p">)[</span><span class="mi">0</span><span class="p">]:</span><span class="s">&quot;enum&quot;</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">fr</span></div>

<div class="viewcode-block" id="H2OFrame.isfactor"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.isfactor">[docs]</a>  <span class="k">def</span> <span class="nf">isfactor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test if the selection is a factor column.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      True if the column is categorical; otherwise False. For String columns, the result</span>
<span class="sd">      is False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">#TODO: list for fr.ncol &gt; 1 ?</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types_valid</span><span class="p">():</span>
      <span class="k">return</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">itervalues</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="s">&quot;enum&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">bool</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;is.factor&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_eager_scalar</span><span class="p">()]</span></div>

<div class="viewcode-block" id="H2OFrame.anyfactor"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.anyfactor">[docs]</a>  <span class="k">def</span> <span class="nf">anyfactor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test if H2OFrame has any factor columns.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      True if there are any categorical columns; False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;any.factor&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_eager_scalar</span><span class="p">())</span></div>

<div class="viewcode-block" id="H2OFrame.transpose"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.transpose">[docs]</a>  <span class="k">def</span> <span class="nf">transpose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Transpose rows and columns of H2OFrame.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      The transpose of the input frame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span></div>

<div class="viewcode-block" id="H2OFrame.strsplit"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.strsplit">[docs]</a>  <span class="k">def</span> <span class="nf">strsplit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Split the strings in the target column on the given pattern</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pattern : str</span>
<span class="sd">      The split pattern.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame containing columns of the split strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;strsplit&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">))</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">nrows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span>
    <span class="k">return</span> <span class="n">fr</span></div>

<div class="viewcode-block" id="H2OFrame.countmatches"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.countmatches">[docs]</a>  <span class="k">def</span> <span class="nf">countmatches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;For each string in the column, count the occurrences of pattern.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pattern : str</span>
<span class="sd">      The pattern to count matches on in each string.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A single-column H2OFrame containing the counts for the per-row occurrences of</span>
<span class="sd">      pattern in the input column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;countmatches&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">))</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">nrows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">ncols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span>
    <span class="k">return</span> <span class="n">fr</span></div>

<div class="viewcode-block" id="H2OFrame.trim"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.trim">[docs]</a>  <span class="k">def</span> <span class="nf">trim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Trim white space on the left and right of strings in a single-column H2OFrame.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame with trimmed strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;trim&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">nrows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">ncol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span>
    <span class="k">return</span> <span class="n">fr</span></div>
  
<div class="viewcode-block" id="H2OFrame.substring"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.substring">[docs]</a>  <span class="k">def</span> <span class="nf">substring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_index</span><span class="p">,</span> <span class="n">end_index</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;For each string, return a new string that is a substring of the original string. If end_index is not </span>
<span class="sd">    specified, then the substring extends to the end of the original string. If the start_index is longer than</span>
<span class="sd">    the length of the string, or is greater than or equal to the end_index, an empty string is returned. Negative</span>
<span class="sd">    start_index is coerced to 0. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    start_index : int</span>
<span class="sd">      The index of the original string at which to start the substring, inclusive.</span>
<span class="sd">    end_index: int, optional</span>
<span class="sd">      The index of the original string at which to end the substring, exclusive. </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      An H2OFrame containing the specified substrings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;substring&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">start_index</span><span class="p">,</span> <span class="n">end_index</span><span class="p">))</span> 
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">nrows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">ncol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span>
    <span class="k">return</span> <span class="n">fr</span></div>

<div class="viewcode-block" id="H2OFrame.lstrip"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.lstrip">[docs]</a>  <span class="k">def</span> <span class="nf">lstrip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">set</span> <span class="o">=</span> <span class="s">&quot; &quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a copy of the column with leading characters removed.</span>
<span class="sd">    The set argument is a string specifying the set of characters to be removed.</span>
<span class="sd">    If omitted, the set argument defaults to removing whitespace.</span>

<span class="sd">    Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      set : str</span>
<span class="sd">        Set of characters to lstrip from strings in column</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame with lstripped strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># work w/ None; parity with python lstrip</span>
    <span class="k">if</span> <span class="nb">set</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="nb">set</span> <span class="o">=</span> <span class="s">&quot; &quot;</span>

    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;lstrip&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="nb">set</span><span class="p">))</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">nrows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">ncol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span>
    <span class="k">return</span> <span class="n">fr</span></div>

<div class="viewcode-block" id="H2OFrame.rstrip"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.rstrip">[docs]</a>  <span class="k">def</span> <span class="nf">rstrip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">set</span> <span class="o">=</span> <span class="s">&quot; &quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a copy of the column with trailing characters removed.</span>
<span class="sd">    The set argument is a string specifying the set of characters to be removed.</span>
<span class="sd">    If omitted, the set argument defaults to removing whitespace.</span>

<span class="sd">    Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      set : str</span>
<span class="sd">        Set of characters to rstrip from strings in column</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame with rstripped strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># work w/ None; parity with python rstrip</span>
    <span class="k">if</span> <span class="nb">set</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="nb">set</span> <span class="o">=</span> <span class="s">&quot; &quot;</span>

    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;rstrip&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="nb">set</span><span class="p">))</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">nrows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">ncol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span>
    <span class="k">return</span> <span class="n">fr</span></div>

<div class="viewcode-block" id="H2OFrame.nchar"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.nchar">[docs]</a>  <span class="k">def</span> <span class="nf">nchar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Count the number of characters in each string of single-column H2OFrame.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A single-column H2OFrame containing the per-row character count.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;strlen&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span></div>

<div class="viewcode-block" id="H2OFrame.table"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.table">[docs]</a>  <span class="k">def</span> <span class="nf">table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data2</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dense</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute the counts of values appearing in a column, or co-occurence counts between</span>
<span class="sd">    two columns.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      data2 : H2OFrame</span>
<span class="sd">        Default is None, can be an optional single column to aggregate counts by.</span>
<span class="sd">      dense : bool</span>
<span class="sd">        Default is True, for dense representation, which lists only non-zero counts, 1 combination per row. Set to False </span>
<span class="sd">        to expand counts across all combinations.  </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame of the counts at each combination of factor levels</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;table&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">data2</span><span class="p">,</span><span class="n">dense</span><span class="p">))</span> <span class="k">if</span> <span class="n">data2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;table&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">dense</span><span class="p">))</span></div>

<div class="viewcode-block" id="H2OFrame.hist"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.hist">[docs]</a>  <span class="k">def</span> <span class="nf">hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">breaks</span><span class="o">=</span><span class="s">&quot;Sturges&quot;</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute a histogram over a numeric column.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    breaks: str, int, list</span>
<span class="sd">      Can be one of &quot;Sturges&quot;, &quot;Rice&quot;, &quot;sqrt&quot;, &quot;Doane&quot;, &quot;FD&quot;, &quot;Scott.&quot;</span>
<span class="sd">      Can be a single number for the number of breaks.</span>
<span class="sd">      Can be a list containing sthe split points, e.g., [-50,213.2123,9324834]</span>
<span class="sd">      If breaks is &quot;FD&quot;, the MAD is used over the IQR in computing bin width.</span>
<span class="sd">    plot : bool, default=True</span>
<span class="sd">      If True, then a plot is generated</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      If plot is False, return H2OFrame with these columns: breaks, counts, mids_true,</span>
<span class="sd">      mids, and density; otherwise produce the plot.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">frame</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;hist&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">breaks</span><span class="p">))</span><span class="o">.</span><span class="n">_frame</span><span class="p">()</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="s">&quot;counts&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">densities</span> <span class="o">=</span> <span class="p">[[(</span><span class="n">frame</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">&quot;counts&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">total</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s">&quot;breaks&quot;</span><span class="p">]</span><span class="o">-</span><span class="n">frame</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;breaks&quot;</span><span class="p">]))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">frame</span><span class="p">[</span><span class="s">&quot;counts&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nrow</span><span class="p">)]</span>
    <span class="n">densities</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">densities_frame</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="p">(</span><span class="n">densities</span><span class="p">)</span>
    <span class="n">densities_frame</span><span class="o">.</span><span class="n">set_names</span><span class="p">([</span><span class="s">&quot;density&quot;</span><span class="p">])</span>
    <span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">densities_frame</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="n">imp</span><span class="o">.</span><span class="n">find_module</span><span class="p">(</span><span class="s">&#39;matplotlib&#39;</span><span class="p">)</span>
        <span class="kn">import</span> <span class="nn">matplotlib</span>
        <span class="k">if</span> <span class="s">&#39;server&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;server&#39;</span><span class="p">]:</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s">&#39;Agg&#39;</span><span class="p">,</span> <span class="n">warn</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
      <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;matplotlib is required to make the histogram plot. Set `plot` to False, if a plot is not desired.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

      <span class="n">lower</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="s">&quot;breaks&quot;</span><span class="p">])</span>
      <span class="n">clist</span> <span class="o">=</span> <span class="n">h2o</span><span class="o">.</span><span class="n">as_list</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="s">&quot;counts&quot;</span><span class="p">],</span> <span class="n">use_pandas</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
      <span class="n">clist</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
      <span class="n">clist</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
      <span class="n">mlist</span> <span class="o">=</span> <span class="n">h2o</span><span class="o">.</span><span class="n">as_list</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="s">&quot;mids&quot;</span><span class="p">],</span> <span class="n">use_pandas</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
      <span class="n">mlist</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
      <span class="n">mlist</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
      <span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">clist</span><span class="p">]</span>
      <span class="n">counts</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
      <span class="n">mids</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">mlist</span><span class="p">]</span>
      <span class="n">mids</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">lower</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Frequency&#39;</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Histogram of {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">mids</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="s">&#39;server&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;server&#39;</span><span class="p">]):</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">frame</span></div>

<div class="viewcode-block" id="H2OFrame.sub"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.sub">[docs]</a>  <span class="k">def</span> <span class="nf">sub</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">replacement</span><span class="p">,</span> <span class="n">ignore_case</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Substitute the first occurrence of pattern in a string with replacement.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pattern : str</span>
<span class="sd">      A regular expression.</span>

<span class="sd">    replacement : str</span>
<span class="sd">      A replacement string.</span>

<span class="sd">    ignore_case : bool</span>
<span class="sd">      If True then pattern will match against upper and lower case.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;replacefirst&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">replacement</span><span class="p">,</span> <span class="n">ignore_case</span><span class="p">))</span></div>

<div class="viewcode-block" id="H2OFrame.gsub"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.gsub">[docs]</a>  <span class="k">def</span> <span class="nf">gsub</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">replacement</span><span class="p">,</span> <span class="n">ignore_case</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Globally substitute occurrences of pattern in a string with replacement.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pattern : str</span>
<span class="sd">      A regular expression.</span>

<span class="sd">    replacement : str</span>
<span class="sd">      A replacement string.</span>

<span class="sd">    ignore_case : bool</span>
<span class="sd">      If True then pattern will match against upper and lower case.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;replaceall&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">replacement</span><span class="p">,</span> <span class="n">ignore_case</span><span class="p">))</span></div>

<div class="viewcode-block" id="H2OFrame.interaction"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.interaction">[docs]</a>  <span class="k">def</span> <span class="nf">interaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factors</span><span class="p">,</span> <span class="n">pairwise</span><span class="p">,</span> <span class="n">max_factors</span><span class="p">,</span> <span class="n">min_occurrence</span><span class="p">,</span> <span class="n">destination_frame</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Categorical Interaction Feature Creation in H2O.</span>
<span class="sd">    Creates a frame in H2O with n-th order interaction features between categorical columns, as specified by</span>
<span class="sd">    the user.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    factors : list</span>
<span class="sd">        factors Factor columns (either indices or column names).</span>
<span class="sd">    pairwise : bool</span>
<span class="sd">      Whether to create pairwise interactions between factors (otherwise create one</span>
<span class="sd">      higher-order interaction). Only applicable if there are 3 or more factors.</span>
<span class="sd">    max_factors: int</span>
<span class="sd">      Max. number of factor levels in pair-wise interaction terms (if enforced, one extra</span>
<span class="sd">      catch-all factor will be made)</span>
<span class="sd">    min_occurrence: int</span>
<span class="sd">      Min. occurrence threshold for factor levels in pair-wise interaction terms</span>
<span class="sd">    destination_frame: str, optional</span>
<span class="sd">      A string indicating the destination key.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">h2o</span><span class="o">.</span><span class="n">interaction</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">factors</span><span class="o">=</span><span class="n">factors</span><span class="p">,</span> <span class="n">pairwise</span><span class="o">=</span><span class="n">pairwise</span><span class="p">,</span> <span class="n">max_factors</span><span class="o">=</span><span class="n">max_factors</span><span class="p">,</span>
                           <span class="n">min_occurrence</span><span class="o">=</span><span class="n">min_occurrence</span><span class="p">,</span> <span class="n">destination_frame</span><span class="o">=</span><span class="n">destination_frame</span><span class="p">)</span></div>

<div class="viewcode-block" id="H2OFrame.toupper"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.toupper">[docs]</a>  <span class="k">def</span> <span class="nf">toupper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Translate characters from lower to upper case for a particular column</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;toupper&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>

<div class="viewcode-block" id="H2OFrame.tolower"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.tolower">[docs]</a>  <span class="k">def</span> <span class="nf">tolower</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Translate characters from upper to lower case for a particular column</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;tolower&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>

<div class="viewcode-block" id="H2OFrame.rep_len"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.rep_len">[docs]</a>  <span class="k">def</span> <span class="nf">rep_len</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length_out</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Replicates the values in `data` in the H2O backend</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    length_out : int</span>
<span class="sd">      Number of columns of the resulting H2OFrame</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;rep_len&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">length_out</span><span class="p">))</span></div>

<div class="viewcode-block" id="H2OFrame.scale"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.scale">[docs]</a>  <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Centers and/or scales the columns of the self._newExpr</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    center : bool, list</span>
<span class="sd">      If True, then demean the data by the mean. If False, no shifting is done.</span>
<span class="sd">      If a list, then shift each column by the given amount in the list.</span>
<span class="sd">    scale : bool, list</span>
<span class="sd">      If True, then scale the data by the column standard deviation. If False, no scaling</span>
<span class="sd">      is done.</span>
<span class="sd">      If a list, then scale each column by the given amount in the list.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;scale&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">scale</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>

<div class="viewcode-block" id="H2OFrame.signif"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.signif">[docs]</a>  <span class="k">def</span> <span class="nf">signif</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Round doubles/floats to the given number of significant digits.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    digits : int, default=6</span>
<span class="sd">      Number of significant digits to round doubles/floats.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;signif&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">digits</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>

<div class="viewcode-block" id="H2OFrame.round"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.round">[docs]</a>  <span class="k">def</span> <span class="nf">round</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Round doubles/floats to the given number of decimal places.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    digits : int, default=0</span>
<span class="sd">      Number of decimal places to round doubles/floats. Rounding to a negative number of decimal places is not </span>
<span class="sd">      supported. For rounding off a 5, the IEC 60559 standard is used, go to the even digit. Therefore rounding 2.5 </span>
<span class="sd">      gives 2 and rounding 3.5 gives 4.</span>
<span class="sd">      </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;round&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">digits</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span></div>

<div class="viewcode-block" id="H2OFrame.asnumeric"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.asnumeric">[docs]</a>  <span class="k">def</span> <span class="nf">asnumeric</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;All factor columns converted to numeric.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;as.numeric&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types_valid</span><span class="p">():</span>
      <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="s">&quot;real&quot;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>
    <span class="k">return</span> <span class="n">fr</span></div>

<div class="viewcode-block" id="H2OFrame.ascharacter"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.ascharacter">[docs]</a>  <span class="k">def</span> <span class="nf">ascharacter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;All columns converted to String columns</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;as.character&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types_valid</span><span class="p">():</span>
      <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="s">&quot;string&quot;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>
    <span class="k">return</span> <span class="n">fr</span></div>

<div class="viewcode-block" id="H2OFrame.na_omit"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.na_omit">[docs]</a>  <span class="k">def</span> <span class="nf">na_omit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove rows with NAs from the H2OFrame.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;na.omit&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">nrows</span><span class="o">=-</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">fr</span></div>
 
<div class="viewcode-block" id="H2OFrame.isna"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.isna">[docs]</a>  <span class="k">def</span> <span class="nf">isna</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;For each element in an H2OFrame, determine if it is NA or not.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame of 1s and 0s. 1 means the value was NA.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;is.na&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">nrows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">nrows</span>
    <span class="k">return</span> <span class="n">fr</span></div>

<div class="viewcode-block" id="H2OFrame.year"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.year">[docs]</a>  <span class="k">def</span> <span class="nf">year</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      Year column from a msec-since-Epoch column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;year&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types_valid</span><span class="p">():</span>
      <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="s">&quot;int&quot;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>
    <span class="k">return</span> <span class="n">fr</span></div>

<div class="viewcode-block" id="H2OFrame.month"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.month">[docs]</a>  <span class="k">def</span> <span class="nf">month</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      Month column from a msec-since-Epoch column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;month&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types_valid</span><span class="p">():</span>
      <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="s">&quot;int&quot;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>
    <span class="k">return</span> <span class="n">fr</span></div>

<div class="viewcode-block" id="H2OFrame.week"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.week">[docs]</a>  <span class="k">def</span> <span class="nf">week</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      Week column from a msec-since-Epoch column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;week&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types_valid</span><span class="p">():</span>
      <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="s">&quot;int&quot;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>
    <span class="k">return</span> <span class="n">fr</span></div>

<div class="viewcode-block" id="H2OFrame.day"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.day">[docs]</a>  <span class="k">def</span> <span class="nf">day</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      Day column from a msec-since-Epoch column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;day&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types_valid</span><span class="p">():</span>
      <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="s">&quot;int&quot;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>
    <span class="k">return</span> <span class="n">fr</span></div>

<div class="viewcode-block" id="H2OFrame.dayOfWeek"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.dayOfWeek">[docs]</a>  <span class="k">def</span> <span class="nf">dayOfWeek</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      Day-of-Week column from a msec-since-Epoch column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;dayOfWeek&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types_valid</span><span class="p">():</span>
      <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="s">&quot;int&quot;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>
    <span class="k">return</span> <span class="n">fr</span></div>

<div class="viewcode-block" id="H2OFrame.hour"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.hour">[docs]</a>  <span class="k">def</span> <span class="nf">hour</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      Hour-of-Day column from a msec-since-Epoch column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;hour&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types_valid</span><span class="p">():</span>
      <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="s">&quot;int&quot;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>
    <span class="k">return</span> <span class="n">fr</span></div>

<div class="viewcode-block" id="H2OFrame.runif"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.runif">[docs]</a>  <span class="k">def</span> <span class="nf">runif</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate a column of random numbers drawn from a uniform distribution [0,1) and</span>
<span class="sd">    having the same data layout as the calling H2OFrame instance.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    seed : int, optional</span>
<span class="sd">      A random seed. If None, then one will be generated.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      Single-column H2OFrame filled with doubles sampled uniformly from [0,1).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;h2o.runif&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">seed</span><span class="p">))</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">nrows</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nrow</span>
    <span class="k">return</span> <span class="n">fr</span></div>

<div class="viewcode-block" id="H2OFrame.stratified_split"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.stratified_split">[docs]</a>  <span class="k">def</span> <span class="nf">stratified_split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">test_frac</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="n">seed</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Construct a column that can be used to perform a random stratified split.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      test_frac : float, default=0.2</span>
<span class="sd">        The fraction of rows that will belong to the &quot;test&quot;.</span>
<span class="sd">      seed      : int</span>
<span class="sd">        For seeding the random splitting.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      A categorical column of two levels &quot;train&quot; and &quot;test&quot;.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">      &gt;&gt;&gt; my_stratified_split = my_frame[&quot;response&quot;].stratified_split(test_frac=0.3,seed=12349453)</span>
<span class="sd">      &gt;&gt;&gt; train = my_frame[my_stratified_split==&quot;train&quot;]</span>
<span class="sd">      &gt;&gt;&gt; test  = my_frame[my_stratified_split==&quot;test&quot;]</span>

<span class="sd">      # check the distributions among the initial frame, and the train/test frames match</span>
<span class="sd">      &gt;&gt;&gt; my_frame[&quot;response&quot;].table()[&quot;Count&quot;] / my_frame[&quot;response&quot;].table()[&quot;Count&quot;].sum()</span>
<span class="sd">      &gt;&gt;&gt; train[&quot;response&quot;].table()[&quot;Count&quot;] / train[&quot;response&quot;].table()[&quot;Count&quot;].sum()</span>
<span class="sd">      &gt;&gt;&gt; test[&quot;response&quot;].table()[&quot;Count&quot;] / test[&quot;response&quot;].table()[&quot;Count&quot;].sum()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&#39;h2o.random_stratified_split&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">test_frac</span><span class="p">,</span> <span class="n">seed</span><span class="p">))</span></div>

<div class="viewcode-block" id="H2OFrame.match"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.match">[docs]</a>  <span class="k">def</span> <span class="nf">match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">nomatch</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes a vector of the positions of (first) matches of its first argument in its second.</span>

<span class="sd">    :param table:</span>
<span class="sd">    :param nomatch:</span>

<span class="sd">    :return: H2OFrame of one boolean column</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;match&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">nomatch</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span></div>

<div class="viewcode-block" id="H2OFrame.cut"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.cut">[docs]</a>  <span class="k">def</span> <span class="nf">cut</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">breaks</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">include_lowest</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">dig_lab</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Cut a numeric vector into factor &quot;buckets&quot;. Similar to R&#39;s cut method.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    breaks : list</span>
<span class="sd">      The cut points in the numeric vector (must span the range of the col.)</span>
<span class="sd">    labels: list</span>
<span class="sd">      Factor labels, defaults to set notation of intervals defined by breaks.</span>
<span class="sd">    include_lowest : bool</span>
<span class="sd">      By default,  cuts are defined as (lo,hi]. If True, get [lo,hi].</span>
<span class="sd">    right : bool</span>
<span class="sd">      Include the high value: (lo,hi]. If False, get (lo,hi).</span>
<span class="sd">    dig_lab: int</span>
<span class="sd">      Number of digits following the decimal point to consider.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      Single-column H2OFrame of categorical data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;cut&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">breaks</span><span class="p">,</span><span class="n">labels</span><span class="p">,</span><span class="n">include_lowest</span><span class="p">,</span><span class="n">right</span><span class="p">,</span><span class="n">dig_lab</span><span class="p">),</span> <span class="n">cache</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">ncols</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">nrows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrow</span>
    <span class="n">fr</span><span class="o">.</span><span class="n">_ex</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="s">&quot;enum&quot;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">fr</span></div>

<div class="viewcode-block" id="H2OFrame.which"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.which">[docs]</a>  <span class="k">def</span> <span class="nf">which</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Equivalent to [ index for index,value in enumerate(self) if value ]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Single-column H2OFrame filled with 0-based indices for which the elements are not</span>
<span class="sd">    zero.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;which&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">))</span></div>

<div class="viewcode-block" id="H2OFrame.ifelse"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.ifelse">[docs]</a>  <span class="k">def</span> <span class="nf">ifelse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">yes</span><span class="p">,</span><span class="n">no</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Equivalent to [y if t else n for t,y,n in zip(self,yes,no)]</span>

<span class="sd">    Based on the booleans in the test vector, the output has the values of the</span>
<span class="sd">    yes and no vectors interleaved (or merged together).  All Frames must have</span>
<span class="sd">    the same row count.  Single column frames are broadened to match wider</span>
<span class="sd">    Frames.  Scalars are allowed, and are also broadened to match wider frames.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    test : H2OFrame (self)</span>
<span class="sd">      Frame of values treated as booleans; may be a single column</span>
<span class="sd">    yes : H2OFrame</span>
<span class="sd">      Frame to use if [test] is true ; may be a scalar or single column</span>
<span class="sd">    no : H2OFrame</span>
<span class="sd">      Frame to use if [test] is false; may be a scalar or single column</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame of the merged yes/no Frames/scalars according to the test input frame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;ifelse&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">yes</span><span class="p">,</span><span class="n">no</span><span class="p">))</span></div>

<div class="viewcode-block" id="H2OFrame.apply"><a class="viewcode-back" href="../../frame.html#h2o.frame.H2OFrame.apply">[docs]</a>  <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fun</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Apply a lambda expression to an H2OFrame.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">      fun: lambda</span>
<span class="sd">        A lambda expression to be applied per row or per column</span>
<span class="sd">    axis: int</span>
<span class="sd">      0: apply to each column; 1: apply to each row</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">      H2OFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">.astfun</span> <span class="kn">import</span> <span class="n">_bytecode_decompile_lambda</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;margin must be either 0 (cols) or 1 (rows).&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fun</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;No function to apply.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span><span class="mi">0</span><span class="p">))</span> <span class="ow">and</span> <span class="n">fun</span><span class="o">.</span><span class="n">__name__</span> <span class="o">==</span> <span class="p">(</span><span class="k">lambda</span><span class="p">:</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span><span class="p">:</span>  <span class="c"># have lambda</span>
      <span class="n">res</span> <span class="o">=</span> <span class="n">_bytecode_decompile_lambda</span><span class="p">(</span><span class="n">fun</span><span class="o">.</span><span class="n">__code__</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">H2OFrame</span><span class="o">.</span><span class="n">_expr</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">ExprNode</span><span class="p">(</span><span class="s">&quot;apply&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">axis</span><span class="o">==</span><span class="mi">0</span><span class="p">),</span><span class="o">*</span><span class="n">res</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;unimpl: not a lambda&quot;</span><span class="p">)</span></div></div>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, H2O.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>